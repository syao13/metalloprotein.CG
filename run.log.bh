##!/usr/bash

## for each of the metal in Zn Mg Ca Fe Na, show only one as example

## Test run for just bootstrapping, comment out the rest, and print out angle distribution 
./znCoordinations.pl ../metalloproteins/protein_list_Zn.txt Zn -d ../output_allMetal/stats.Zn -angleBD ../output_allMetal/angleDist.Zn.txt

## Put in the "vote" binding ligands via chi-squared stat, add in a 7-ligand CG temporarily, and print out probs for each coordination number (CN).
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bind.Na -angleBD ../output_allMetal/angleDist.bind.Na.txt >../output_allMetal/numLigProb.Na.txt; date

#Thu Jul 30 22:06:04 EDT 2015
#Fri Jul 31 03:18:14 EDT 2015

#date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bind.Fe -angleBD ../output_allMetal/angleDist.bind.Fe.txt > ../output_allMetal/numLigProb.Fe.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bind.Ca -angleBD ../output_allMetal/angleDist.bind.Ca.txt > ../output_allMetal/numLigProb.Ca.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bind.Mg -angleBD ../output_allMetal/angleDist.bind.Mg.txt > ../output_allMetal/numLigProb.Mg.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bind.Zn -angleBD ../output_allMetal/angleDist.bind.Zn.txt > ../output_allMetal/numLigProb.Zn.txt; date 
#Thu Jul 30 22:28:35 EDT 2015
#Fri Jul 31 00:23:26 EDT 2015
#Fri Jul 31 02:11:48 EDT 2015
#Fri Jul 31 16:21:32 EDT 2015
#Fri Jul 31 17:48:31 EDT 2015


## Run the prob up to 10-ligand, rename the above to ligNumProb.Zn.7.txt
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bind.Na -angleBD ../output_allMetal/angleDist.bind.Na.txt >../output_allMetal/ligNumProb.Na.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bind.Fe -angleBD ../output_allMetal/angleDist.bind.Fe.txt > ../output_allMetal/ligNumProb.Fe.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bind.Ca -angleBD ../output_allMetal/angleDist.bind.Ca.txt > ../output_allMetal/ligNumProb.Ca.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bind.Zn -angleBD ../output_allMetal/angleDist.bind.Zn.txt > ../output_allMetal/ligNumProb.Zn.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bind.Mg -angleBD ../output_allMetal/angleDist.bind.Mg.txt > ../output_allMetal/ligNumProb.Mg.txt; date

Sat Aug  1 11:18:10 EDT 2015
Sat Aug  1 16:32:45 EDT 2015
Sat Aug  1 18:30:28 EDT 2015
Sat Aug  1 20:30:13 EDT 2015
Sat Aug  1 22:01:13 EDT 2015
Sun Aug  2 12:14:43 EDT 2015

## Try bootstrap with Tet, Tbp, Oct, and add Spy (and maybe pbp)
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.spy.Zn; date

## Add Pentagonal Bipyramidal in bootstrap 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.pbp.Zn; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.pbp.Ca; date

#Wed Aug  5 23:19:30 EDT 2015
#Deviation sorted: #Octahedral = 974 #PentagonalBipyramidal = 29 #Tetrahedral = 18039 #TrigonalBipyramidal = 2553
#Thu Aug  6 00:46:51 EDT 2015
#Deviation sorted: #Octahedral = 5899 #PentagonalBipyramidal = 4138 #Tetrahedral = 5036 #TrigonalBipyramidal = 6543
#Thu Aug  6 03:31:55 EDT 2015

## removed all metal-metal cluster
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bootstrap.Zn; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bootstrap.Ca; date

#Thu Aug  6 15:50:53 EDT 2015
#Deviation sorted: Octahedral = 975 PentagonalBipyramidal = 28 Tetrahedral = 18036 TrigonalBipyramidal = 2556
#Thu Aug  6 17:17:40 EDT 2015
#Deviation sorted: Octahedral = 5893 PentagonalBipyramidal = 4136 Tetrahedral = 5023 TrigonalBipyramidal = 6556
#Thu Aug  6 19:52:11 EDT 2015

date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bootstrap.Fe; date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bootstrap.Na; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bootstrap.Mg; date

#Thu Aug  6 23:24:15 EDT 2015
#Deviation sorted: Octahedral = 8630 PentagonalBipyramidal = 57 Tetrahedral = 2202 TrigonalBipyramidal = 4803
#Fri Aug  7 01:22:07 EDT 2015
#Deviation sorted: Octahedral = 2212 PentagonalBipyramidal = 208 Tetrahedral = 6046 TrigonalBipyramidal = 4376
#Fri Aug  7 06:45:14 EDT 2015
#Deviation sorted: Octahedral = 12814 PentagonalBipyramidal = 353 Tetrahedral = 10952 TrigonalBipyramidal = 10318
#Fri Aug  7 20:53:57 EDT 2015

## Add spy in bootstrap to only 5-lig shells
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.spy.Fe; date

#Fri Aug  7 12:20:48 EDT 2015 
#Deviation sorted: Octahedral = 8630 PentagonalBipyramidal = 57 SquarePyramidal = 3192 Tetrahedral = 2157 TrigonalBipyramidal = 1656
#Fri Aug  7 14:20:16 EDT 2015

## print out bond length to visualize.
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.Na.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.Zn.txt; date; 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.Ca.txt; date; 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.Fe.txt; date;
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.Mg.txt; date;

## Same as bootstrap

## The above was actually printing out bond-length after ligand chosing, not bootstrapping. So re-run
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.bs.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.bs.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.bs.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.bs.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.bs.Mg.txt &

## Add r value and r free along with bond length, make bootstrap a workflow choice
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.rvalue.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.rvalue.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.rvalue.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.rvalue.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.rvalue.Mg.txt &

## The bootstrapping may include 2nd shell atoms because a generous distance cutoff. So remove the 2nd shell by checking is there any atoms in between.
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.rm2ndshell.Na -bondLength ../output_allMetal/bondLength.rm2ndshell.Na.txt >../output_allMetal/output.rm2ndshell.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.rm2ndshell.Ca -bondLength ../output_allMetal/bondLength.rm2ndshell.Ca.txt >../output_allMetal/output.rm2ndshell.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.rm2ndshell.Fe -bondLength ../output_allMetal/bondLength.rm2ndshell.Fe.txt >../output_allMetal/output.rm2ndshell.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.rm2ndshell.Zn -bondLength ../output_allMetal/bondLength.rm2ndshell.Zn.txt >../output_allMetal/output.rm2ndshell.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.rm2ndshell.Mg -bondLength ../output_allMetal/bondLength.rm2ndshell.Mg.txt >../output_allMetal/output.rm2ndshell.Mg.txt &

## Throw carbon in to see what happens
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.carbon.Na -bondLength ../output_allMetal/bondLength.carbon.Na.txt >../output_allMetal/output.carbon.Na.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.carbon.Ca -bondLength ../output_allMetal/bondLength.carbon.Ca.txt >../output_allMetal/output.carbon.Ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.carbon.Fe -bondLength ../output_allMetal/bondLength.carbon.Fe.txt >../output_allMetal/output.carbon.Fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.carbon.Zn -bondLength ../output_allMetal/bondLength.carbon.Zn.txt >../output_allMetal/output.carbon.Zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.carbon.Mg -bondLength ../output_allMetal/bondLength.carbon.Mg.txt >../output_allMetal/output.carbon.Mg.txt &

## get first shell cutoff and ligand element passed in as parameters
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs shellCutoff 3.302 ON ../output_allMetal/stats.cutoff.Na -bondLength ../output_allMetal/bondLength.cutoff.Na.txt >../output_allMetal/output.cutoff.Na.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs shellCutoff 3.094 O ../output_allMetal/stats.cutoff.Ca -bondLength ../output_allMetal/bondLength.cutoff.Ca.txt >../output_allMetal/output.cutoff.Ca.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs shellCutoff 2.640 SON ../output_allMetal/stats.cutoff.Fe -bondLength ../output_allMetal/bondLength.cutoff.Fe.txt >../output_allMetal/output.cutoff.Fe.txt& 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs shellCutoff 2.783 SON ../output_allMetal/stats.cutoff.Zn -bondLength ../output_allMetal/bondLength.cutoff.Zn.txt >../output_allMetal/output.cutoff.Zn.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs shellCutoff 2.856 ON ../output_allMetal/stats.cutoff.Mg -bondLength ../output_allMetal/bondLength.cutoff.Mg.txt >../output_allMetal/output.cutoff.Mg.txt&





