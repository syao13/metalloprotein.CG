##!/usr/bash

## for each of the metal in Zn Mg Ca Fe Na, show only one as example

## Test run for just bootstrapping, comment out the rest, and print out angle distribution 
./znCoordinations.pl ../metalloproteins/protein_list_Zn.txt Zn -d ../output_allMetal/stats.Zn -angleBD ../output_allMetal/angleDist.Zn.txt

## Put in the "vote" binding ligands via chi-squared stat, add in a 7-ligand CG temporarily, and print out probs for each coordination number (CN).
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bind.Na -angleBD ../output_allMetal/angleDist.bind.Na.txt >../output_allMetal/numLigProb.Na.txt; date

#Thu Jul 30 22:06:04 EDT 2015
#Fri Jul 31 03:18:14 EDT 2015

#date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bind.Fe -angleBD ../output_allMetal/angleDist.bind.Fe.txt > ../output_allMetal/numLigProb.Fe.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bind.Ca -angleBD ../output_allMetal/angleDist.bind.Ca.txt > ../output_allMetal/numLigProb.Ca.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bind.Mg -angleBD ../output_allMetal/angleDist.bind.Mg.txt > ../output_allMetal/numLigProb.Mg.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bind.Zn -angleBD ../output_allMetal/angleDist.bind.Zn.txt > ../output_allMetal/numLigProb.Zn.txt; date 
#Thu Jul 30 22:28:35 EDT 2015
#Fri Jul 31 00:23:26 EDT 2015
#Fri Jul 31 02:11:48 EDT 2015
#Fri Jul 31 16:21:32 EDT 2015
#Fri Jul 31 17:48:31 EDT 2015


## Run the prob up to 10-ligand, rename the above to ligNumProb.Zn.7.txt
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bind.Na -angleBD ../output_allMetal/angleDist.bind.Na.txt >../output_allMetal/ligNumProb.Na.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bind.Fe -angleBD ../output_allMetal/angleDist.bind.Fe.txt > ../output_allMetal/ligNumProb.Fe.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bind.Ca -angleBD ../output_allMetal/angleDist.bind.Ca.txt > ../output_allMetal/ligNumProb.Ca.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bind.Zn -angleBD ../output_allMetal/angleDist.bind.Zn.txt > ../output_allMetal/ligNumProb.Zn.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bind.Mg -angleBD ../output_allMetal/angleDist.bind.Mg.txt > ../output_allMetal/ligNumProb.Mg.txt; date

Sat Aug  1 11:18:10 EDT 2015
Sat Aug  1 16:32:45 EDT 2015
Sat Aug  1 18:30:28 EDT 2015
Sat Aug  1 20:30:13 EDT 2015
Sat Aug  1 22:01:13 EDT 2015
Sun Aug  2 12:14:43 EDT 2015

## Try bootstrap with Tet, Tbp, Oct, and add Spy (and maybe pbp)
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.spy.Zn; date

## Add Pentagonal Bipyramidal in bootstrap 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.pbp.Zn; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.pbp.Ca; date

#Wed Aug  5 23:19:30 EDT 2015
#Deviation sorted: #Octahedral = 974 #PentagonalBipyramidal = 29 #Tetrahedral = 18039 #TrigonalBipyramidal = 2553
#Thu Aug  6 00:46:51 EDT 2015
#Deviation sorted: #Octahedral = 5899 #PentagonalBipyramidal = 4138 #Tetrahedral = 5036 #TrigonalBipyramidal = 6543
#Thu Aug  6 03:31:55 EDT 2015

## removed all metal-metal cluster
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bootstrap.Zn; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bootstrap.Ca; date

#Thu Aug  6 15:50:53 EDT 2015
#Deviation sorted: Octahedral = 975 PentagonalBipyramidal = 28 Tetrahedral = 18036 TrigonalBipyramidal = 2556
#Thu Aug  6 17:17:40 EDT 2015
#Deviation sorted: Octahedral = 5893 PentagonalBipyramidal = 4136 Tetrahedral = 5023 TrigonalBipyramidal = 6556
#Thu Aug  6 19:52:11 EDT 2015

date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bootstrap.Fe; date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bootstrap.Na; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bootstrap.Mg; date

#Thu Aug  6 23:24:15 EDT 2015
#Deviation sorted: Octahedral = 8630 PentagonalBipyramidal = 57 Tetrahedral = 2202 TrigonalBipyramidal = 4803
#Fri Aug  7 01:22:07 EDT 2015
#Deviation sorted: Octahedral = 2212 PentagonalBipyramidal = 208 Tetrahedral = 6046 TrigonalBipyramidal = 4376
#Fri Aug  7 06:45:14 EDT 2015
#Deviation sorted: Octahedral = 12814 PentagonalBipyramidal = 353 Tetrahedral = 10952 TrigonalBipyramidal = 10318
#Fri Aug  7 20:53:57 EDT 2015

## Add spy in bootstrap to only 5-lig shells
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.spy.Fe; date

#Fri Aug  7 12:20:48 EDT 2015 
#Deviation sorted: Octahedral = 8630 PentagonalBipyramidal = 57 SquarePyramidal = 3192 Tetrahedral = 2157 TrigonalBipyramidal = 1656
#Fri Aug  7 14:20:16 EDT 2015

## print out bond length to visualize.
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.Na.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.Zn.txt; date; 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.Ca.txt; date; 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.Fe.txt; date;
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.Mg.txt; date;

## Same as bootstrap

## The above was actually printing out bond-length after ligand chosing, not bootstrapping. So re-run
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.bs.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.bs.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.bs.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.bs.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.bs.Mg.txt &

## Add r value and r free along with bond length, make bootstrap a workflow choice
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.rvalue.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.rvalue.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.rvalue.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.rvalue.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.rvalue.Mg.txt &

## The bootstrapping may include 2nd shell atoms because a generous distance cutoff. So remove the 2nd shell by checking is there any atoms in between.
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.rm2ndshell.Na -bondLength ../output_allMetal/bondLength.rm2ndshell.Na.txt >../output_allMetal/output.rm2ndshell.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.rm2ndshell.Ca -bondLength ../output_allMetal/bondLength.rm2ndshell.Ca.txt >../output_allMetal/output.rm2ndshell.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.rm2ndshell.Fe -bondLength ../output_allMetal/bondLength.rm2ndshell.Fe.txt >../output_allMetal/output.rm2ndshell.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.rm2ndshell.Zn -bondLength ../output_allMetal/bondLength.rm2ndshell.Zn.txt >../output_allMetal/output.rm2ndshell.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.rm2ndshell.Mg -bondLength ../output_allMetal/bondLength.rm2ndshell.Mg.txt >../output_allMetal/output.rm2ndshell.Mg.txt &

## Throw carbon in to see what happens
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.carbon.Na -bondLength ../output_allMetal/bondLength.carbon.Na.txt >../output_allMetal/output.carbon.Na.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.carbon.Ca -bondLength ../output_allMetal/bondLength.carbon.Ca.txt >../output_allMetal/output.carbon.Ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.carbon.Fe -bondLength ../output_allMetal/bondLength.carbon.Fe.txt >../output_allMetal/output.carbon.Fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.carbon.Zn -bondLength ../output_allMetal/bondLength.carbon.Zn.txt >../output_allMetal/output.carbon.Zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.carbon.Mg -bondLength ../output_allMetal/bondLength.carbon.Mg.txt >../output_allMetal/output.carbon.Mg.txt &

## Had a mistake in including the carbons, need rerun
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.carbon1.Na -bondLength ../output_allMetal/bondLength.carbon1.Na.txt >../output_allMetal/output.carbon1.Na.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.carbon1.Ca -bondLength ../output_allMetal/bondLength.carbon1.Ca.txt >../output_allMetal/output.carbon1.Ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.carbon1.Fe -bondLength ../output_allMetal/bondLength.carbon1.Fe.txt >../output_allMetal/output.carbon1.Fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.carbon1.Zn -bondLength ../output_allMetal/bondLength.carbon1.Zn.txt >../output_allMetal/output.carbon1.Zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.carbon1.Mg -bondLength ../output_allMetal/bondLength.carbon1.Mg.txt >../output_allMetal/output.carbon1.Mg.txt &


## get first shell cutoff and ligand element passed in as parameters
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs shellCutoff 3.302 ON ../output_allMetal/stats.cutoff.Na -bondLength ../output_allMetal/bondLength.cutoff.Na.txt >../output_allMetal/output.cutoff.Na.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs shellCutoff 3.094 O ../output_allMetal/stats.cutoff.Ca -bondLength ../output_allMetal/bondLength.cutoff.Ca.txt >../output_allMetal/output.cutoff.Ca.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs shellCutoff 2.640 SON ../output_allMetal/stats.cutoff.Fe -bondLength ../output_allMetal/bondLength.cutoff.Fe.txt >../output_allMetal/output.cutoff.Fe.txt& 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs shellCutoff 2.783 SON ../output_allMetal/stats.cutoff.Zn -bondLength ../output_allMetal/bondLength.cutoff.Zn.txt >../output_allMetal/output.cutoff.Zn.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs shellCutoff 2.856 ON ../output_allMetal/stats.cutoff.Mg -bondLength ../output_allMetal/bondLength.cutoff.Mg.txt >../output_allMetal/output.cutoff.Mg.txt&

## test run on zn to compare the difference between single ligand voting and all-ligand chi squared test.
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.singleLig.Zn -bondLength ../output_allMetal/bondLength.singleLig.Zn.txt >../output_allMetal/output.singleLig.Zn.txt
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig.Zn -bondLength ../output_allMetal/bondLength.chiSquaredLig.Zn.txt >../output_allMetal/output.chiSquaredLig.Zn.txt

## Rerun to have R input for testing the angle space 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig1.Zn -bondLength ../output_allMetal/bondLength.singleLig1.Zn.txt -r ../output_allMetal/rAllLig.singleLig.txt >../output_allMetal/output.tooClose.Zn.txt
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig1.Zn -bondLength ../output_allMetal/bondLength.chiSquaredLig1.Zn.txt -r ../output_allMetal/rAllLig.chiSquaredLig.txt

## Generate sequences
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.ss.singleLig.Zn -s s s ../output_allMetal/seqs.SEQRES.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.as.singleLig.Zn -s a s ../output_allMetal/seqs.ATOM.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.sb.singleLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.singleLig.zn.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.ss.chiSquaredLig.Zn -s s s ../output_allMetal/seqs.SEQRES.shell.chiSquaredLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.as.chiSquaredLig.Zn -s a s ../output_allMetal/seqs.ATOM.shell.chiSquaredLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.sb.chiSquaredLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.chiSquaredLig.zn.txt &

## 10.15, change the input and output file accordingly for singleLig and chiSquaredLig
./seq_alignment.R

## 10.16, removed 3-ligand inclusion?
./nonRedundancy.R

## 11.2, rerun to get R input after fixing &orderedAngles
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig2.Zn -r ../output_allMetal/rAllLig.singleLig.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig2.Zn -r ../output_allMetal/rAllLig.chiSquaredLig.txt &

## 11.30 remove 3-ligand sites from printing for singleLig
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.ss.singleLig.Zn -s s s ../output_allMetal/seqs.SEQRES.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.as.singleLig.Zn -s a s ../output_allMetal/seqs.ATOM.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.sb.singleLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.singleLig.zn.txt &

## rerun SEQRES.bind.chiSquaredLig to see why is it different for bind and shell seq 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.sb.chiSquaredLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.chiSquaredLig.zn.txt >../output_allMetal/out.noProtLig.txt

## 12.1 run down to non redundancy for singleLig and chiSquaredLig
./seq_alignment.R; ./nonRedundancy.R

## 12.3 get the smallest angle spreadsheet for rf input, and add number of ligands, method, year, and resolution columns
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig.rf.Zn -rf ../output_allMetal/rf.singleLig.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig.rf.Zn -rf ../output_allMetal/rf.chiSquaredLig.txt &

## 12.4 rerun to get R spreadsheet again with a new format: all angles are in one single column and need to be split in R
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig3.Zn -r ../output_allMetal/rAllLig.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig3.Zn -r ../output_allMetal/rAllLig.chiSquaredLig.zn.txt &

## 12.9 change the kmeans format to handle all angles in one column, and change the code manully to switch between singleLig/chiSquaredLig and 5/6 angle space: run 4 times done.
./kmeans.mnr.optimalk.R

## make the directory an argument to pass in on command line in R
./write_fasta.R ../output_allMetal/

## run interproscan accordingly, _f22 on Hypnos doesn't work again. Ran on hemera vm
/mlab/data/software/interproscan/interproscan.sh -i ../output_allMetal/non_redundant_zinc.singleLig.zn.fa -f tsv -iprlookup -pa -goterms -o ../output_allMetal/non_redundant_zinc.singleLig.zn.ipr.tsv
/mlab/data/software/interproscan/interproscan.sh -i ../output_allMetal/non_redundant_zinc.chiSquaredLig.zn.fa -f tsv -iprlookup -pa -goterms -o ../output_allMetal/non_redundant_zinc.chiSquaredLig.zn.ipr.tsv

## functional_characterization.R, make the directory an argument to pass in on command line.
./functional_characterization.R ../output_allMetal/

## proceed with measures and graphs.
./measures.vs.k.R ../output_allMetal/
./cluster_metric_graphs.R ../output_allMetal/

## 12.10, fix the measures*.R only used 5 angle space for all calculation. rerun single6 and chisqr6
./measures.vs.k.R ../output_allMetal/
./cluster_metric_graphs.R ../output_allMetal/

## change the kmeans to take command line argument, make 5/6 angle space an option as well, and change rep to 500
./kmeans.mnr.optimalk.R ../output_single5 5; ./kmeans.mnr.optimalk.R ../output_single6 6
./kmeans.mnr.optimalk.R ../output_chiSquared5 5; ./kmeans.mnr.optimalk.R ../output_chiSquared6 6

## 12.11, continue with functional analysis
./functional_characterization.R ../output_chiSquared5 && ./functional_characterization.R ../output_chiSquared6
./functional_characterization.R ../output_single5 && ./functional_characterization.R ../output_single6

## 
./measures.vs.k.R ../output_single5 5 && ./measures.vs.k.R ../output_single6 6

## 12.12
./measures.vs.k.R ../output_chiSquared5 5 && ./measures.vs.k.R ../output_chiSquared6 6

./cluster_metric_graphs.R ../output_single5
./cluster_metric_graphs.R ../output_single6
./cluster_metric_graphs.R ../output_chiSquared5
./cluster_metric_graphs.R ../output_chiSquared6

## 12.15 make the directory, angle space, num of norm, comp, comb clusters as arguements
./cluster.centers.prob.R ../output_chiSquared6/ 6 7 6 12 | less

## rerun to test 2.5 std single ligand selection criteria, get diff result files at the same time
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single/stats.zn -s s s ../output_2.5single/seqs.SEQRES.shell.txt -s a s ../output_2.5single/seqs.ATOM.shell.txt -s s b ../output_2.5single/seqs.SEQRES.bind.txt -r ../output_2.5single/r.allLig.txt -rf ../output_2.5single/rf.smallest.txt

## 12.16 sequence options are exclusive, the above only got sb opt run, has to run separately
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single/stats.ss -s s s ../output_2.5single/seqs.SEQRES.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single/stats.as -s a s ../output_2.5single/seqs.ATOM.shell.txt &

## test 2 std single ligand selection criteria, get diff result files at the same time
## never do this again!
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.ss -s s s ../output_2single/seqs.SEQRES.shell.txt -r ../output_2single/r.allLig.txt -rf ../output_2single/rf.smallest.txt &
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.as -s a s ../output_2single/seqs.SEQRES.shell.txt &
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.sb -s s b ../output_2single/seqs.ATOM.shell.txt &

## the names of the above seq results are wrong, rename the later two and rerun to get ss
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.ss -s s s ../output_2single/seqs.SEQRES.shell.txt &

## proceed with everything
./seq_alignment.R ../output_2.5single/
./nonRedundancy.R ../output_2.5single/
./rf.smallAngle.R ../output_2.5single/

## make a copy of the output_2.5single folder
./kmeans.mnr.optimalk.R ../output_2.5single5 5
./kmeans.mnr.optimalk.R ../output_2.5single6 6

## Actually the seq files are cancatenate to exsisting ones, then proceed same thing with output_2single
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.ss -s s s ../output_2single/seqs.SEQRES.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.as -s a s ../output_2single/seqs.ATOM.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.sb -s s b ../output_2single/seqs.SEQRES.bind.txt &
./seq_alignment.R ../output_2single/ && ./nonRedundancy.R ../output_2single/ && ./rf.smallAngle.R ../output_2single/

./kmeans.mnr.optimalk.R ../output_2single5 5
./kmeans.mnr.optimalk.R ../output_2single6 6

## 12.17 
./write_fasta.R ../output_2single5
./write_fasta.R ../output_2single6
./write_fasta.R ../output_2.5single5
./write_fasta.R ../output_2.5single6

## ssh interproscan
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single6
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single6
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## All of the above four failed!

## start other metals
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.ss -s s s ../output_Na_chiSquared/seqs.SEQRES.shell.txt -r ../output_Na_chiSquared/r.allLig.txt -rf ../output_Na_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.ss -s s s ../output_Na_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.ss -s s b ../output_Na_chiSquared/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.ss -s s s ../output_Ca_chiSquared/seqs.SEQRES.shell.txt -r ../output_Ca_chiSquared/r.allLig.txt -rf ../output_Ca_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.ss -s s s ../output_Ca_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.ss -s s b ../output_Ca_chiSquared/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.ss -s s s ../output_Fe_chiSquared/seqs.SEQRES.shell.txt -r ../output_Fe_chiSquared/r.allLig.txt -rf ../output_Fe_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.ss -s s s ../output_Fe_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.ss -s s b ../output_Fe_chiSquared/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.ss -s s s ../output_Mg_chiSquared/seqs.SEQRES.shell.txt -r ../output_Mg_chiSquared/r.allLig.txt -rf ../output_Mg_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.ss -s s s ../output_Mg_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.ss -s s b ../output_Mg_chiSquared/seqs.SEQRES.bind.txt &


## 12.18 Try to rerun interproscan, 5 and 6 angle space do not affect the functional mapping, so only need to once
## on hemera fedora20@vm
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single5
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## on interproscan vm
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## The -s a s option actually didn't get running from above, need rerun
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.as -s a s ../output_Na_chiSquared/seqs.ATOM.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.as -s a s ../output_Ca_chiSquared/seqs.ATOM.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.as -s a s ../output_Fe_chiSquared/seqs.ATOM.shell.txt & 
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.as -s a s ../output_Mg_chiSquared/seqs.ATOM.shell.txt &

## Use 3 std for now to run single ligand selection on other metals
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.ss -s s s ../output_Na_singleLig/seqs.SEQRES.shell.txt -r ../output_Na_singleLig/r.allLig.txt -rf ../output_Na_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.as -s a s ../output_Na_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.sb -s s b ../output_Na_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.ss -s s s ../output_Ca_singleLig/seqs.SEQRES.shell.txt -r ../output_Ca_singleLig/r.allLig.txt -rf ../output_Ca_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.as -s a s ../output_Ca_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.sb -s s b ../output_Ca_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.ss -s s s ../output_Fe_singleLig/seqs.SEQRES.shell.txt -r ../output_Fe_singleLig/r.allLig.txt -rf ../output_Fe_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.as -s a s ../output_Fe_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.sb -s s b ../output_Fe_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.ss -s s s ../output_Mg_singleLig/seqs.SEQRES.shell.txt -r ../output_Mg_singleLig/r.allLig.txt -rf ../output_Mg_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.as -s a s ../output_Mg_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.sb -s s b ../output_Mg_singleLig/seqs.SEQRES.bind.txt &

## 12.19, the one run on interproscan VM was failed again, don't know if it's because background Mg running was messing it up
## on hemera fedora20@vm
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single5
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## on interproscan vm (screen 8)
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single6
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## hemera vm worked, and interproscan vm failed
## set up screen 8 to be hemera vm

## 12.20, finish running 2std and 3std on zinc
./functional_characterization.R ../output_2.5single5
./measures.vs.k.R ../output_2.5single5 5
./cluster_metric_graphs.R ../output_2.5single5

./functional_characterization.R ../output_2.5single6 && ./measures.vs.k.R ../output_2.5single6 6 && ./cluster_metric_graphs.R ../output_2.5single6 &
./functional_characterization.R ../output_2single5 && ./measures.vs.k.R ../output_2single5 5 && ./cluster_metric_graphs.R ../output_2single5 &
./functional_characterization.R ../output_2single6 && ./measures.vs.k.R ../output_2single6 6 && ./cluster_metric_graphs.R ../output_2single6 &

## Ca, Na, Fe, Mg
./seq_alignment.R ../output_Ca_singleLig
./nonRedundancy.R ../output_Ca_singleLig 
./write_fasta.R ../output_Ca_singleLig 
./seq_alignment.R ../output_Ca_chiSquared && ./nonRedundancy.R ../output_Ca_chiSquared && ./write_fasta.R ../output_Ca_chiSquared 

./seq_alignment.R ../output_Na_singleLig && ./nonRedundancy.R ../output_Na_singleLig && ./write_fasta.R ../output_Na_singleLig 
./seq_alignment.R ../output_Na_chiSquared && ./nonRedundancy.R ../output_Na_chiSquared && ./write_fasta.R ../output_Na_chiSquared 

./seq_alignment.R ../output_Mg_singleLig && ./nonRedundancy.R ../output_Mg_singleLig && ./write_fasta.R ../output_Mg_singleLig 
./seq_alignment.R ../output_Mg_chiSquared && ./nonRedundancy.R ../output_Mg_chiSquared && ./write_fasta.R ../output_Mg_chiSquared 

./seq_alignment.R ../output_Fe_singleLig && ./nonRedundancy.R ../output_Fe_singleLig && ./write_fasta.R ../output_Fe_singleLig 
./seq_alignment.R ../output_Fe_chiSquared && ./nonRedundancy.R ../output_Fe_chiSquared && ./write_fasta.R ../output_Fe_chiSquared 


## interproscan once write_fasta.R done running
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Ca_chiSquared
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 12.21, do chiSquared first, before # of std is decided
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Na_chiSquared
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## try different angle space reduction on zinc with 3 std
./kmeans.mnr.optimalk.R ../output_single3 3 && ./kmeans.mnr.optimalk.R ../output_single4 4

## 12.22
./functional_characterization.R ../output_single3 && ./functional_characterization.R ../output_single4 &&./measures.vs.k.R ../output_single3 3 && ./measures.vs.k.R ../output_single4 4 && ./cluster_metric_graphs.R ../output_single3 && ./cluster_metric_graphs.R ../output_single4


## The interproscan VM is good now
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Fe_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Mg_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 12.27 run the metals again with 2.5 std for single
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.ss -s s s ../output_Na_singleLig/seqs.SEQRES.shell.txt -r ../output_Na_singleLig/r.allLig.txt -rf ../output_Na_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.as -s a s ../output_Na_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.sb -s s b ../output_Na_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.ss -s s s ../output_Ca_singleLig/seqs.SEQRES.shell.txt -r ../output_Ca_singleLig/r.allLig.txt -rf ../output_Ca_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.as -s a s ../output_Ca_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.sb -s s b ../output_Ca_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.ss -s s s ../output_Fe_singleLig/seqs.SEQRES.shell.txt -r ../output_Fe_singleLig/r.allLig.txt -rf ../output_Fe_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.as -s a s ../output_Fe_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.sb -s s b ../output_Fe_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.ss -s s s ../output_Mg_singleLig/seqs.SEQRES.shell.txt -r ../output_Mg_singleLig/r.allLig.txt -rf ../output_Mg_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.as -s a s ../output_Mg_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.sb -s s b ../output_Mg_singleLig/seqs.SEQRES.bind.txt &


## 12.28 added the bond lengths of smallest angle ligands to -rf opt output
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats -rf ../output_Mg_singleLig/rf.smallest.mg.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats -rf ../output_Ca_singleLig/rf.smallest.ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats -rf ../output_Fe_singleLig/rf.smallest.fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats -rf ../output_Na_singleLig/rf.smallest.na.txt &

## Try above with Zn
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single5/stats -rf ../output_2.5single5/rf.smallest.zn.txt &

./seq_alignment.R ../output_Ca_singleLig && ./nonRedundancy.R ../output_Ca_singleLig && ./write_fasta.R ../output_Ca_singleLig
./seq_alignment.R ../output_Fe_singleLig && ./nonRedundancy.R ../output_Fe_singleLig && ./write_fasta.R ../output_Fe_singleLig
./seq_alignment.R ../output_Na_singleLig && ./nonRedundancy.R ../output_Na_singleLig && ./write_fasta.R ../output_Na_singleLig
./seq_alignment.R ../output_Mg_singleLig 
./nonRedundancy.R ../output_Mg_singleLig && ./write_fasta.R ../output_Mg_singleLig

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Ca_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Fe_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Na_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 12.29, rename the output_2.5single5 to output_Zn_singleLig5
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Zn_singleLig5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Mg_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## redo the Ca and Na chiSquared because they were using the 5.15 interproscan on hemera fedora20VM
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Ca_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Na_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 2016.1.3, Try the bi-aa criteria to separate the data into normal and compressed baesed on the average bondlength vs. smallest angles group
./rf.biaa.R ../output_Zn_biaa5
./rf.biaa.R ../output_Zn_biaa6
./kmeans.mnr.optimalk.R ../output_Zn_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Zn_biaa6 6
./kmeans.mnr.optimalk.R ../output_Zn_biaa3 3 && ./kmeans.mnr.optimalk.R ../output_Zn_biaa4 4

## 1.4, 
./functional_characterization.R ../output_Zn_biaa6 && ./measures.vs.k.R ../output_Zn_biaa6 6 && ./cluster_metric_graphs.R ../output_Zn_biaa6 
./functional_characterization.R ../output_Zn_biaa5 && ./measures.vs.k.R ../output_Zn_biaa5 5 && ./cluster_metric_graphs.R ../output_Zn_biaa5 
./functional_characterization.R ../output_Zn_biaa4 && ./measures.vs.k.R ../output_Zn_biaa4 4 && ./cluster_metric_graphs.R ../output_Zn_biaa4 
./functional_characterization.R ../output_Zn_biaa3 && ./measures.vs.k.R ../output_Zn_biaa3 3 && ./cluster_metric_graphs.R ../output_Zn_biaa3 


## 1.5, proceed with other metals, and try RF separation and bi-aa separation
./rf.smallAngle.R ../output_Ca_singleLig 55 65
./rf.smallAngle.R ../output_Na_singleLig 45 60
./rf.smallAngle.R ../output_Mg_singleLig 52 68
./rf.smallAngle.R ../output_Fe_singleLig 63 73

./rf.biaa.R ../output_Ca_biaa6
./rf.biaa.R ../output_Na_biaa3
./rf.biaa.R ../output_Mg_biaa6


## duplicate each folder
./kmeans.mnr.optimalk.R ../output_Ca_single5 5 && ./kmeans.mnr.optimalk.R ../output_Ca_single6 6 && ./kmeans.mnr.optimalk.R ../output_Ca_single3 3 && ./kmeans.mnr.optimalk.R ../output_Ca_single4 4

./kmeans.mnr.optimalk.R ../output_Na_single5 5 
./kmeans.mnr.optimalk.R ../output_Na_single6 6 && ./kmeans.mnr.optimalk.R ../output_Na_single4 4 && ./kmeans.mnr.optimalk.R ../output_Na_single3 3

./kmeans.mnr.optimalk.R ../output_Mg_single5 5 
./kmeans.mnr.optimalk.R ../output_Mg_single6 6 
./kmeans.mnr.optimalk.R ../output_Mg_single3 3 
./kmeans.mnr.optimalk.R ../output_Mg_single4 4

./kmeans.mnr.optimalk.R ../output_Fe_single5 5 && ./kmeans.mnr.optimalk.R ../output_Fe_single6 6 && ./kmeans.mnr.optimalk.R ../output_Fe_single4 4 && ./kmeans.mnr.optimalk.R ../output_Fe_single3 3

## bi-aa
./kmeans.mnr.optimalk.R ../output_Ca_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Ca_biaa6 6 
./kmeans.mnr.optimalk.R ../output_Ca_biaa3 3 && ./kmeans.mnr.optimalk.R ../output_Ca_biaa4 4

./kmeans.mnr.optimalk.R ../output_Na_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Na_biaa6 6  
./kmeans.mnr.optimalk.R ../output_Na_biaa4 4 && ./kmeans.mnr.optimalk.R ../output_Na_biaa3 3

./kmeans.mnr.optimalk.R ../output_Mg_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Mg_biaa6 6 && ./kmeans.mnr.optimalk.R ../output_Mg_biaa3 3 && ./kmeans.mnr.optimalk.R ../output_Mg_biaa4 4

./kmeans.mnr.optimalk.R ../output_Fe_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Fe_biaa6 6 
./kmeans.mnr.optimalk.R ../output_Fe_biaa4 4  
./kmeans.mnr.optimalk.R ../output_Fe_biaa3 3

## 1.6, finish runing everthing, single/biaa & 3/4/5/6
## ./functional_characterization.R ../output_Mg_single6 && ./measures.vs.k.R ../output_Mg_single6 6 && ./cluster_metric_graphs.R ../output_Mg_single6
./functional_characterization.R ../output_Mg_single5 && ./measures.vs.k.R ../output_Mg_single5 5 && ./cluster_metric_graphs.R ../output_Mg_single5
./functional_characterization.R ../output_Mg_single4 && ./measures.vs.k.R ../output_Mg_single4 4 && ./cluster_metric_graphs.R ../output_Mg_single4
./functional_characterization.R ../output_Mg_single3 && ./measures.vs.k.R ../output_Mg_single3 3 && ./cluster_metric_graphs.R ../output_Mg_single3

date; ./functional_characterization.R ../output_Mg_biaa6 && date; ./measures.vs.k.R ../output_Mg_biaa6 6 && ./cluster_metric_graphs.R ../output_Mg_biaa6
./functional_characterization.R ../output_Mg_biaa5 && ./measures.vs.k.R ../output_Mg_biaa5 5 && ./cluster_metric_graphs.R ../output_Mg_biaa5
./functional_characterization.R ../output_Mg_biaa4 && ./measures.vs.k.R ../output_Mg_biaa4 4 && ./cluster_metric_graphs.R ../output_Mg_biaa4
./functional_characterization.R ../output_Mg_biaa3 && ./measures.vs.k.R ../output_Mg_biaa3 3 && ./cluster_metric_graphs.R ../output_Mg_biaa3

./functional_characterization.R ../output_Ca_single6 && ./measures.vs.k.R ../output_Ca_single6 6 && ./cluster_metric_graphs.R ../output_Ca_single6
./functional_characterization.R ../output_Ca_single5 && ./measures.vs.k.R ../output_Ca_single5 5 && ./cluster_metric_graphs.R ../output_Ca_single5
./functional_characterization.R ../output_Ca_single4 && ./measures.vs.k.R ../output_Ca_single4 4 && ./cluster_metric_graphs.R ../output_Ca_single4
./functional_characterization.R ../output_Ca_single3 && ./measures.vs.k.R ../output_Ca_single3 3 && ./cluster_metric_graphs.R ../output_Ca_single3

./functional_characterization.R ../output_Ca_biaa6 && ./measures.vs.k.R ../output_Ca_biaa6 6 && ./cluster_metric_graphs.R ../output_Ca_biaa6
./functional_characterization.R ../output_Ca_biaa5 && ./measures.vs.k.R ../output_Ca_biaa5 5 && ./cluster_metric_graphs.R ../output_Ca_biaa5
./functional_characterization.R ../output_Ca_biaa4 && ./measures.vs.k.R ../output_Ca_biaa4 4 && ./cluster_metric_graphs.R ../output_Ca_biaa4
./functional_characterization.R ../output_Ca_biaa3 && ./measures.vs.k.R ../output_Ca_biaa3 3 && ./cluster_metric_graphs.R ../output_Ca_biaa3

./functional_characterization.R ../output_Fe_single6 && ./measures.vs.k.R ../output_Fe_single6 6 && ./cluster_metric_graphs.R ../output_Fe_single6
./functional_characterization.R ../output_Fe_single5 && ./measures.vs.k.R ../output_Fe_single5 5 && ./cluster_metric_graphs.R ../output_Fe_single5
./functional_characterization.R ../output_Fe_single4 && ./measures.vs.k.R ../output_Fe_single4 4 && ./cluster_metric_graphs.R ../output_Fe_single4
./functional_characterization.R ../output_Fe_single3 && ./measures.vs.k.R ../output_Fe_single3 3 && ./cluster_metric_graphs.R ../output_Fe_single3

./functional_characterization.R ../output_Fe_biaa6 && ./measures.vs.k.R ../output_Fe_biaa6 6 && ./cluster_metric_graphs.R ../output_Fe_biaa6
./functional_characterization.R ../output_Fe_biaa5 && ./measures.vs.k.R ../output_Fe_biaa5 5 && ./cluster_metric_graphs.R ../output_Fe_biaa5
./functional_characterization.R ../output_Fe_biaa4 && ./measures.vs.k.R ../output_Fe_biaa4 4 && ./cluster_metric_graphs.R ../output_Fe_biaa4
./functional_characterization.R ../output_Fe_biaa3 && ./measures.vs.k.R ../output_Fe_biaa3 3 && ./cluster_metric_graphs.R ../output_Fe_biaa3

./functional_characterization.R ../output_Na_single6 && ./measures.vs.k.R ../output_Na_single6 6 && ./cluster_metric_graphs.R ../output_Na_single6
./functional_characterization.R ../output_Na_single5 && ./measures.vs.k.R ../output_Na_single5 5 && ./cluster_metric_graphs.R ../output_Na_single5
./functional_characterization.R ../output_Na_single4 && ./measures.vs.k.R ../output_Na_single4 4 && ./cluster_metric_graphs.R ../output_Na_single4
./functional_characterization.R ../output_Na_single3 && ./measures.vs.k.R ../output_Na_single3 3 && ./cluster_metric_graphs.R ../output_Na_single3

./functional_characterization.R ../output_Na_biaa6 && ./measures.vs.k.R ../output_Na_biaa6 6 && ./cluster_metric_graphs.R ../output_Na_biaa6
./functional_characterization.R ../output_Na_biaa5 && ./measures.vs.k.R ../output_Na_biaa5 5 && ./cluster_metric_graphs.R ../output_Na_biaa5
./functional_characterization.R ../output_Na_biaa4 && ./measures.vs.k.R ../output_Na_biaa4 4 && ./cluster_metric_graphs.R ../output_Na_biaa4
./functional_characterization.R ../output_Na_biaa3 && ./measures.vs.k.R ../output_Na_biaa3 3 && ./cluster_metric_graphs.R ../output_Na_biaa3


## 1.8, after corrected angles
./kmeans.mnr.optimalk.R ../Mg_results/biaa5_correctedangle 5 && ./kmeans.mnr.optimalk.R ../Mg_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Na_results/biaa6_correctedangle 6

## 1.9
nice -10 ./functional_characterization.R ../Zn_results/biaa5_correctedangle && ./measures.vs.k.R ../Zn_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Zn_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Zn_results/biaa6_correctedangle && ./measures.vs.k.R ../Zn_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Zn_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Mg_results/biaa5_correctedangle && ./measures.vs.k.R ../Mg_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Mg_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Mg_results/biaa6_correctedangle && ./measures.vs.k.R ../Mg_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Mg_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Ca_results/biaa5_correctedangle && ./measures.vs.k.R ../Ca_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Ca_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Ca_results/biaa6_correctedangle && ./measures.vs.k.R ../Ca_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Ca_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Fe_results/biaa5_correctedangle && ./measures.vs.k.R ../Fe_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Fe_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Fe_results/biaa6_correctedangle && ./measures.vs.k.R ../Fe_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Fe_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Na_results/biaa5_correctedangle && ./measures.vs.k.R ../Na_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Na_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Na_results/biaa6_correctedangle && ./measures.vs.k.R ../Na_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Na_results/biaa6_correctedangle

## 1.10, Use the corrected angles as rules to separate normal vs. compressed angles
./rf.correctedangle.R ../Zn_results/crtag5_correctedangle
./rf.correctedangle.R ../Mg_results/crtag5_correctedangle
./rf.correctedangle.R ../Ca_results/crtag5_correctedangle
./rf.correctedangle.R ../Fe_results/crtag5_correctedangle
./rf.correctedangle.R ../Na_results/crtag5_correctedangle

cp -r Zn_results/crtag5_correctedangle/ Zn_results/crtag6_correctedangle/
cp -r Mg_results/crtag5_correctedangle/ Mg_results/crtag6_correctedangle/
cp -r Ca_results/crtag5_correctedangle/ Ca_results/crtag6_correctedangle/
cp -r Fe_results/crtag5_correctedangle/ Fe_results/crtag6_correctedangle/
cp -r Na_results/crtag5_correctedangle/ Na_results/crtag6_correctedangle/

cp -r Zn_results/crtag5/ Zn_results/crtag6/
cp -r Mg_results/crtag5/ Mg_results/crtag6/
cp -r Ca_results/crtag5/ Ca_results/crtag6/
cp -r Fe_results/crtag5/ Fe_results/crtag6/
cp -r Na_results/crtag5/ Na_results/crtag6/

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag6_correctedangle 6


## 1.11
nice -10 ./functional_characterization.R ../Zn_results/crtag5_correctedangle && ./measures.vs.k.R ../Zn_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Zn_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Zn_results/crtag6_correctedangle && ./measures.vs.k.R ../Zn_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Zn_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Mg_results/crtag5_correctedangle && ./measures.vs.k.R ../Mg_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Mg_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Mg_results/crtag6_correctedangle && ./measures.vs.k.R ../Mg_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Mg_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Ca_results/crtag5_correctedangle && ./measures.vs.k.R ../Ca_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Ca_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Ca_results/crtag6_correctedangle && ./measures.vs.k.R ../Ca_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Ca_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Fe_results/crtag5_correctedangle && ./measures.vs.k.R ../Fe_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Fe_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Fe_results/crtag6_correctedangle && ./measures.vs.k.R ../Fe_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Fe_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Na_results/crtag5_correctedangle && ./measures.vs.k.R ../Na_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Na_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Na_results/crtag6_correctedangle && ./measures.vs.k.R ../Na_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Na_results/crtag6_correctedangle

## comment out kmean and measures using corrected angles
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag6 6

## rerun measure graph so the rho is more scalable
./cluster_metric_graphs.R ../Zn_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Zn_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Mg_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Mg_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Ca_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Ca_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Fe_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Fe_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Na_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Na_results/crtag6_correctedangle

./cluster_metric_graphs.R ../Zn_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Zn_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Mg_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Mg_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Ca_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Ca_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Fe_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Fe_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Na_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Na_results/biaa6_correctedangle

./cluster_metric_graphs.R ../output_Zn_biaa5
./cluster_metric_graphs.R ../output_Zn_biaa6
./cluster_metric_graphs.R ../output_Mg_biaa5
./cluster_metric_graphs.R ../output_Mg_biaa6
./cluster_metric_graphs.R ../output_Ca_biaa5
./cluster_metric_graphs.R ../output_Ca_biaa6
./cluster_metric_graphs.R ../output_Fe_biaa5
./cluster_metric_graphs.R ../output_Fe_biaa6
./cluster_metric_graphs.R ../output_Na_biaa5
./cluster_metric_graphs.R ../output_Na_biaa6

./cluster_metric_graphs.R ../output_Zn_single5
./cluster_metric_graphs.R ../output_Zn_single6
./cluster_metric_graphs.R ../output_Mg_single5
./cluster_metric_graphs.R ../output_Mg_single6
./cluster_metric_graphs.R ../output_Ca_single5
./cluster_metric_graphs.R ../output_Ca_single6
./cluster_metric_graphs.R ../output_Fe_single5
./cluster_metric_graphs.R ../output_Fe_single6
./cluster_metric_graphs.R ../output_Na_single5
./cluster_metric_graphs.R ../output_Na_single6

nice -10 ./functional_characterization.R ../Zn_results/crtag5 && ./measures.vs.k.R ../Zn_results/crtag5 5 && ./cluster_metric_graphs.R ../Zn_results/crtag5
nice -10 ./functional_characterization.R ../Zn_results/crtag6 && ./measures.vs.k.R ../Zn_results/crtag6 6 && ./cluster_metric_graphs.R ../Zn_results/crtag6
nice -10 ./functional_characterization.R ../Mg_results/crtag5 && ./measures.vs.k.R ../Mg_results/crtag5 5 && ./cluster_metric_graphs.R ../Mg_results/crtag5
nice -10 ./functional_characterization.R ../Mg_results/crtag6 && ./measures.vs.k.R ../Mg_results/crtag6 6 && ./cluster_metric_graphs.R ../Mg_results/crtag6
nice -10 ./functional_characterization.R ../Ca_results/crtag5 && ./measures.vs.k.R ../Ca_results/crtag5 5 && ./cluster_metric_graphs.R ../Ca_results/crtag5
nice -10 ./functional_characterization.R ../Ca_results/crtag6 && ./measures.vs.k.R ../Ca_results/crtag6 6 && ./cluster_metric_graphs.R ../Ca_results/crtag6
nice -10 ./functional_characterization.R ../Fe_results/crtag5 && ./measures.vs.k.R ../Fe_results/crtag5 5 && ./cluster_metric_graphs.R ../Fe_results/crtag5
nice -10 ./functional_characterization.R ../Fe_results/crtag6 && ./measures.vs.k.R ../Fe_results/crtag6 6 && ./cluster_metric_graphs.R ../Fe_results/crtag6
nice -10 ./functional_characterization.R ../Na_results/crtag5 && ./measures.vs.k.R ../Na_results/crtag5 5 && ./cluster_metric_graphs.R ../Na_results/crtag5
nice -10 ./functional_characterization.R ../Na_results/crtag6 && ./measures.vs.k.R ../Na_results/crtag6 6 && ./cluster_metric_graphs.R ../Na_results/crtag6


## Test on 4-ligand only zinc, Rf with and without corrected angle
./rf.crf.R ../Zn_results/4crf_6crtag 58 68
./rf.smallAngle.R ../Zn_results/4rf_6/ 58 68

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4crf_6crtag 6 1
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4rf_6/ 6 0

nice -10 ./functional_characterization.R ../Zn_results/4crf_6crtag && ./measures.vs.k.R ../Zn_results/4crf_6crtag 6 1 && ./cluster_metric_graphs.R ../Zn_results/4crf_6crtag
nice -10 ./functional_characterization.R ../Zn_results/4rf_6 && ./measures.vs.k.R ../Zn_results/4rf_6 6 0 && ./cluster_metric_graphs.R ../Zn_results/4rf_6
## Drop the corrected angles


## 1.19, Test to add #Lig as a dimension 
cp -r root_beforeRF/ rf_6p1
./rf.smallAngle.R ../Zn_results/rf_6p1 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/rf_6p1 6

## Use overall angle standard deviation to normalize
cp -r root_beforeRF/ rf_6plus1
./rf.smallAngle.R ../Zn_results/rf_6plus1 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/rf_6plus1 6

cp -r output_Zn_singleLig6 afterkmeans_6plus1
./measures.vs.k.R ../Zn_results/afterkmeans_6plus1 6 && ./cluster_metric_graphs.R ../Zn_results/afterkmeans_6plus1

nice -10 ./functional_characterization.R ../Zn_results/rf_6p1 6 && ./measures.vs.k.R ../Zn_results/rf_6p1 6 && ./cluster_metric_graphs.R ../Zn_results/rf_6p1
nice -10 ./functional_characterization.R ../Zn_results/rf_6plus1 6 && ./measures.vs.k.R ../Zn_results/rf_6plus1 6 && ./cluster_metric_graphs.R ../Zn_results/rf_6plus1

## Test on 5-ligand zinc, using all-angles space (7 angle space)
cp -r root_beforeRF 5ligand_7
./rf.smallAngle.R ../Zn_results/5ligand_7 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_7 7
nice -10 ./functional_characterization.R ../Zn_results/5ligand_7 && ./measures.vs.k.R ../Zn_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/5ligand_7

## Try the 6 angle space and see if that is what was causing lower rho
cp -r root_beforeRF 5ligand_6
./rf.smallAngle.R ../Zn_results/5ligand_6 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_6 6 && nice -10 ./functional_characterization.R ../Zn_results/5ligand_6 && ./measures.vs.k.R ../Zn_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/5ligand_6

## 10.21, Run all metals with different #lig separately
mv Mg_results/output_Mg_singleLig Mg_results/root_afterRF
mv Ca_results/output_Ca_singleLig Ca_results/root_afterRF
mv Fe_results/output_Fe_singleLig Fe_results/root_afterRF
mv Na_results/output_Na_singleLig Na_results/root_afterRF

cp -r Mg_results/root_afterRF Mg_results/4ligand_7
cp -r Ca_results/root_afterRF Ca_results/4ligand_7
cp -r Fe_results/root_afterRF Fe_results/4ligand_7
cp -r Na_results/root_afterRF Na_results/4ligand_7

cp -r Mg_results/root_afterRF Mg_results/5ligand_6
cp -r Mg_results/root_afterRF Mg_results/5ligand_7
cp -r Ca_results/root_afterRF Ca_results/5ligand_6
cp -r Ca_results/root_afterRF Ca_results/5ligand_7
cp -r Fe_results/root_afterRF Fe_results/5ligand_6
cp -r Fe_results/root_afterRF Fe_results/5ligand_7
cp -r Na_results/root_afterRF Na_results/5ligand_6
cp -r Na_results/root_afterRF Na_results/5ligand_7

cp -r Zn_results/root_afterRF Zn_results/6ligand_6
cp -r Zn_results/root_afterRF Zn_results/6ligand_7
cp -r Mg_results/root_afterRF Mg_results/6ligand_6
cp -r Mg_results/root_afterRF Mg_results/6ligand_7
cp -r Ca_results/root_afterRF Ca_results/6ligand_6
cp -r Ca_results/root_afterRF Ca_results/6ligand_7
cp -r Fe_results/root_afterRF Fe_results/6ligand_6
cp -r Fe_results/root_afterRF Fe_results/6ligand_7
cp -r Na_results/root_afterRF Na_results/6ligand_6
cp -r Na_results/root_afterRF Na_results/6ligand_7

cp -r Mg_results/root_afterRF Mg_results/7ligand_6
cp -r Mg_results/root_afterRF Mg_results/7ligand_7
cp -r Ca_results/root_afterRF Ca_results/7ligand_6
cp -r Fe_results/root_afterRF Fe_results/7ligand_7
cp -r Na_results/root_afterRF Na_results/7ligand_6
cp -r Na_results/root_afterRF Na_results/7ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/4ligand_7 4 7  
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/4ligand_7 4 7 && nice -10 ./functional_characterization.R ../Ca_results/4ligand_7 && ./measures.vs.k.R ../Ca_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/4ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/4ligand_7 4 7 
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/4ligand_7 4 7 
#Some functional analysis failed

nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_6 5 6 
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_6 && ./measures.vs.k.R ../Ca_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_6 && ./measures.vs.k.R ../Fe_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Na_results/5ligand_6 && ./measures.vs.k.R ../Na_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/5ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_7 5 7 
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_7 && ./measures.vs.k.R ../Ca_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_7 && ./measures.vs.k.R ../Fe_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Na_results/5ligand_7 && ./measures.vs.k.R ../Na_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/5ligand_7

## After Robert fixed the functional analysis. So maybe test if the new functional analysis works the same for before
nice -10 ./functional_characterization.R ../Mg_results/output_Mg_single6 & ./measures.vs.k.R ../Mg_results/output_Mg_single6 6 && ./cluster_metric_graphs.R ../Mg_results/output_Mg_single6

nice -10 ./functional_characterization.R ../Fe_results/4ligand_7 && ./measures.vs.k.R ../Fe_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/4ligand_7
## worked!

## still not work, out of boundary; run after another fix
nice -10 ./functional_characterization.R ../Mg_results/4ligand_7 && ./measures.vs.k.R ../Mg_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/4ligand_7
nice -10 ./functional_characterization.R ../Mg_results/5ligand_6 && ./measures.vs.k.R ../Mg_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/5ligand_6
nice -10 ./functional_characterization.R ../Mg_results/5ligand_7 && ./measures.vs.k.R ../Mg_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/5ligand_7
nice -10 ./functional_characterization.R ../Na_results/4ligand_7 && ./measures.vs.k.R ../Na_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/4ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_6 && ./measures.vs.k.R ../Zn_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_6 6 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_6 && ./measures.vs.k.R ../Ca_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_6 && ./measures.vs.k.R ../Fe_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Na_results/6ligand_6 && ./measures.vs.k.R ../Na_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/6ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_7 && ./measures.vs.k.R ../Zn_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_7 6 7 
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_7 && ./measures.vs.k.R ../Ca_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_7 && ./measures.vs.k.R ../Fe_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Na_results/6ligand_7 && ./measures.vs.k.R ../Na_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/6ligand_7

## out of boundary ones, run after another fix
nice -10 ./functional_characterization.R ../Mg_results/6ligand_6 && ./measures.vs.k.R ../Mg_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/6ligand_6
nice -10 ./functional_characterization.R ../Mg_results/6ligand_7 && ./measures.vs.k.R ../Mg_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/6ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_6 7 6 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_6 && ./measures.vs.k.R ../Ca_results/7ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/7ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_7 7 7 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_7 && ./measures.vs.k.R ../Ca_results/7ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/7ligand_7

## finish 8-ligand for Ca
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_6 8 6 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_6 && ./measures.vs.k.R ../Ca_results/8ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/8ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_7 8 7 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_7 && ./measures.vs.k.R ../Ca_results/8ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/8ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/ligNNOO_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/ligNNOO_6
## need to change the #lig check in measure
nice -10 ./measures.vs.k.R ../Zn_results/ligNNOO_6 6 && ./cluster_metric_graphs.R ../Zn_results/ligNNOO_6


## index error on #lig
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4ligand_7correct 4 7 && nice -10 ./functional_characterization.R ../Zn_results/4ligand_7correct && ./measures.vs.k.R ../Zn_results/4ligand_7correct 7 && ./cluster_metric_graphs.R ../Zn_results/4ligand_7correct


## move all number of ligand results to obs
mkdir Mg_results/obs
mv Mg_results/*ligand* Mg_results/obs/.
mkdir Ca_results/obs
mv Ca_results/*ligand* Ca_results/obs/.
mkdir Na_results/obs
mv Na_results/*ligand* Na_results/obs/.
mkdir Fe_results/obs
mv Fe_results/*ligand* Fe_results/obs/.
mkdir Zn_results/obs
Zn_results/*ligand* Zn_results/obs/.
mv Zn_results/ligNNOO_6 Zn_results/obs/.

#rerun everything
cp -r Zn_results/root_afterRF Zn_results/4ligand_6
cp -r Mg_results/root_afterRF Mg_results/4ligand_6
cp -r Ca_results/root_afterRF Ca_results/4ligand_6
cp -r Fe_results/root_afterRF Fe_results/4ligand_6
cp -r Na_results/root_afterRF Na_results/4ligand_6

cp -r Zn_results/root_afterRF Zn_results/5ligand_6
cp -r Zn_results/root_afterRF Zn_results/5ligand_7
cp -r Mg_results/root_afterRF Mg_results/5ligand_6
cp -r Mg_results/root_afterRF Mg_results/5ligand_7
cp -r Ca_results/root_afterRF Ca_results/5ligand_6
cp -r Ca_results/root_afterRF Ca_results/5ligand_7
cp -r Fe_results/root_afterRF Fe_results/5ligand_6
cp -r Fe_results/root_afterRF Fe_results/5ligand_7
cp -r Na_results/root_afterRF Na_results/5ligand_6
cp -r Na_results/root_afterRF Na_results/5ligand_7

cp -r Zn_results/root_afterRF Zn_results/6ligand_6
cp -r Zn_results/root_afterRF Zn_results/6ligand_7
cp -r Mg_results/root_afterRF Mg_results/6ligand_6
cp -r Mg_results/root_afterRF Mg_results/6ligand_7
cp -r Ca_results/root_afterRF Ca_results/6ligand_6
cp -r Ca_results/root_afterRF Ca_results/6ligand_7
cp -r Fe_results/root_afterRF Fe_results/6ligand_6
cp -r Fe_results/root_afterRF Fe_results/6ligand_7
cp -r Na_results/root_afterRF Na_results/6ligand_6
cp -r Na_results/root_afterRF Na_results/6ligand_7

cp -r Ca_results/root_afterRF Ca_results/7ligand_6
cp -r Ca_results/root_afterRF Ca_results/7ligand_7
cp -r Ca_results/root_afterRF Ca_results/8ligand_6
cp -r Ca_results/root_afterRF Ca_results/8ligand_7


nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Zn_results/4ligand_6 && ./measures.vs.k.R ../Zn_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Mg_results/4ligand_6 && ./measures.vs.k.R ../Mg_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Ca_results/4ligand_6 && ./measures.vs.k.R ../Ca_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Fe_results/4ligand_6 && ./measures.vs.k.R ../Fe_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Na_results/4ligand_6 && ./measures.vs.k.R ../Na_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/4ligand_6


nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Zn_results/5ligand_6 && ./measures.vs.k.R ../Zn_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Mg_results/5ligand_6 && ./measures.vs.k.R ../Mg_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_6 && ./measures.vs.k.R ../Ca_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_6 && ./measures.vs.k.R ../Fe_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Na_results/5ligand_6 && ./measures.vs.k.R ../Na_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/5ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Zn_results/5ligand_7 && ./measures.vs.k.R ../Zn_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Mg_results/5ligand_7 && ./measures.vs.k.R ../Mg_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_7 && ./measures.vs.k.R ../Ca_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_7 && ./measures.vs.k.R ../Fe_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Na_results/5ligand_7 && ./measures.vs.k.R ../Na_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/5ligand_7


nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_6 && ./measures.vs.k.R ../Zn_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Mg_results/6ligand_6 && ./measures.vs.k.R ../Mg_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_6 && ./measures.vs.k.R ../Ca_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_6 && ./measures.vs.k.R ../Fe_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Na_results/6ligand_6 && ./measures.vs.k.R ../Na_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/6ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_7 && ./measures.vs.k.R ../Zn_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Mg_results/6ligand_7 && ./measures.vs.k.R ../Mg_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_7 && ./measures.vs.k.R ../Ca_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_7 && ./measures.vs.k.R ../Fe_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Na_results/6ligand_7 && ./measures.vs.k.R ../Na_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/6ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_6 7 6 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_6 && ./measures.vs.k.R ../Ca_results/7ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/7ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_7 7 7 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_7 && ./measures.vs.k.R ../Ca_results/7ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/7ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_6 8 6 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_6 && ./measures.vs.k.R ../Ca_results/8ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/8ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_7 8 7 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_7 && ./measures.vs.k.R ../Ca_results/8ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/8ligand_7

nice -10 ./kmeans.mnr.optimalk.3.R ../Zn_results/ligNNOO_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/ligNNOO_6 && nice -10 ./measures.vs.k.0.R ../Zn_results/ligNNOO_6 6 && ./cluster_metric_graphs.R ../Zn_results/ligNNOO_6


## 1.31, Test all metals together with the same #ligand
nice -10 ./kmeans.mnr.optimalk.2.R allMetal_results/4ligand_6 4 6
nice -10 ./kmeans.mnr.optimalk.2.R allMetal_results/5ligand_6 5 6
nice -10 ./kmeans.mnr.optimalk.2.R allMetal_results/6ligand_6 6 6

## 2.1, combine diff metal files
cat Zn_results/4ligand_6/non_redundant.ipr.tsv Ca_results/4ligand_6/non_redundant.ipr.tsv Na_results/4ligand_6/non_redundant.ipr.tsv Mg_results/4ligand_6/non_redundant.ipr.tsv Fe_results/4ligand_6/non_redundant.ipr.tsv >allMetal_results/4ligand_6/non_redundant.ipr.tsv
cat Zn_results/4ligand_6/r.allLig.txt Ca_results/4ligand_6/r.allLig.txt Na_results/4ligand_6/r.allLig.txt Mg_results/4ligand_6/r.allLig.txt Fe_results/4ligand_6/r.allLig.txt >allMetal_results/4ligand_6/r.allLig.txt

nice -10 ./functional_characterization.R ../allMetal_results/4ligand_6
nice -10 ./functional_characterization.R ../allMetal_results/5ligand_6
nice -10 ./functional_characterization.R ../allMetal_results/6ligand_6

nice -10 ./measures.vs.k.1.R ../allMetal_results/4ligand_6 6 && ./cluster_metric_graphs.R ../allMetal_results/4ligand_6
nice -10 ./measures.vs.k.1.R ../allMetal_results/5ligand_6 6 && ./cluster_metric_graphs.R ../allMetal_results/5ligand_6
nice -10 ./measures.vs.k.1.R ../allMetal_results/6ligand_6 6 && ./cluster_metric_graphs.R ../allMetal_results/6ligand_6

## 2.5 simulation
mkdir 1_1
mkdir 1_2
... 

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 1
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 2
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 3
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 4
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 5
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 6
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 7
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 8
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 9
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 10
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 11
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 12
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 13
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 14
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 15
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 16
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 17
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 18
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 19
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 20


nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 1 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 1
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 2 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 2
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 3 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 3
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 4 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 4
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 5 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 5
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 6 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 6
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 7 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 7
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 8 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 8
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 9 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 9
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 10 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 10
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 11 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 11
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 12 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 12
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 13 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 13
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 14 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 14
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 15 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 15
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 16 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 16
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 17 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 17
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 18 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 18
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 19 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 19
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 20 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 20


## make up for what didn't run correctly before

./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 1
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 2
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 3
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 4
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 5
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 6
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 7
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 8
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 9
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 10


nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 13 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 13 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 13
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 14 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 14 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 14

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 15 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 15 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 15
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 16 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 16 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 16

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 17 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 17 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 17
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 18 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 18 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 18

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 19 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 19 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 19

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 20 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 20 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 20


### 2.15, run non-redundant on all metals together
cat Zn_results/root_afterRF/seqs.SEQRES.shell.txt Mg_results/root_afterRF/seqs.SEQRES.shell.txt Ca_results/root_afterRF/seqs.SEQRES.shell.txt Fe_results/root_afterRF/seqs.SEQRES.shell.txt Na_results/root_afterRF/seqs.SEQRES.shell.txt > allMetal_results/beforeNR/seqs.SEQRES.shell.txt
cat Zn_results/root_afterRF/seqs.SEQRES.bind.txt Mg_results/root_afterRF/seqs.SEQRES.bind.txt Ca_results/root_afterRF/seqs.SEQRES.bind.txt Fe_results/root_afterRF/seqs.SEQRES.bind.txt Na_results/root_afterRF/seqs.SEQRES.bind.txt > allMetal_results/beforeNR/seqs.SEQRES.bind.txt
cat Zn_results/root_afterRF/seqs.ATOM.shell.txt Mg_results/root_afterRF/seqs.ATOM.shell.txt Ca_results/root_afterRF/seqs.ATOM.shell.txt Fe_results/root_afterRF/seqs.ATOM.shell.txt Na_results/root_afterRF/seqs.ATOM.shell.txt > allMetal_results/beforeNR/seqs.ATOM.shell.txt
cat Zn_results/root_afterRF/r.allLig.txt Mg_results/root_afterRF/r.allLig.txt Ca_results/root_afterRF/r.allLig.txt Fe_results/root_afterRF/r.allLig.txt Na_results/root_afterRF/r.allLig.txt > allMetal_results/beforeNR/r.allLig.txt
cat Zn_results/root_afterRF/rf.smallest.txt Mg_results/root_afterRF/rf.smallest.txt Ca_results/root_afterRF/rf.smallest.txt Fe_results/root_afterRF/rf.smallest.txt Na_results/root_afterRF/rf.smallest.txt > allMetal_results/beforeNR/rf.smallest.txt

./seq_alignment.R ../allMetal_results/beforeNR/

## check rmsd of all metal, all number of ligand
./cluster.centers.prob.R ../Na_results/5ligand_6/ 7 10 14 11| less


## Test IA process
./metalCoordinations.pl test.ca.1.txt Ca 3.094 O -i p 0.001 test

## 3.4, respond to the attackiing paper, too close ligands and metal occupancy
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd ../Zn_results/root_fcshell/stats -r ../Zn_results/root_fcshell/r.allLig.occupancy.txt  > ../Zn_results/root_fcshell/out.tooclose.txt

## 3.21, added symmetry related calculation, occupancy, and solvent metal. Test on Zn
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.zn.stats -r test.zn.r.txt 

## 3.24, 
./metalCoordinations.pl test.zn.1000.txt Zn 2.783 SON -dd test.zn.stats -r test.zn.r.txt
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.zn.all.stats -r test.zn.all.r.txt

## 3.25, run on nyx and print out symmetry number with overall overlapping range check; multi processing with PDB parser
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -bs > test.overallSymNum.txt

## 3.27, check metal atoms with symmetry related range, and how many smmetry related sets need to be calculated; single processing with PDB parser
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -bs > test.metSym.txt
R -q -e "x <- read.csv('test.metSym.txt', header = F); summary(x); mean(x[ , 2], na.rm=TRUE)" ## 12.63832
R -q -e "x <- read.csv('test.overallSymNum.txt', header = F); summary(x); mean(x[ , 2], na.rm=TRUE)" ## 36.55767

## 3.28, fix the neighboring XYZ error
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.stats -r test.zn.r.3.28.txt > test.metSym.txt


## 3.30, fix the xyz range error
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.stats -r test.zn.r.3.30.txt > test.metSym.3.30.txt

## 4.4, choose the best alterate locations, and remove sites with non-biological symmetry-related ligands
./metalCoordinations.pl test.ca.2.txt Ca 3.094 O -dd test
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.stats -r test.zn.r.4.4.txt > test.metSym.4.4.txt

## 4.6, check if multi-processing at CG level vs. ordered combo level gives the same results
./metalCoordinations.pl ../new_coordination/pathfile.2.txt Zn 2.783 ONS -i p 0.001 test.combo > test.paraCombo.txt
./metalCoordinations.pl ../new_coordination/pathfile.2.txt Zn 2.783 ONS -i p 0.001 test.CG >test.paraCG.txt

## 4.7, there are different ones between CG and combo, 1KOG, try rerun
./metalCoordinations.pl test.zn.1.txt Zn 2.783 ONS -i p 0.001 test.CG > test.CG.txt
./metalCoordinations.pl test.zn.1.txt Zn 2.783 ONS -i p 0.001 test.combo > test.combo.txt


## Start running everything from the beginning
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_zn/stats -r ../output_zn/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_mg/stats -r ../output_mg/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_ca/stats -r ../output_ca/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_fe/stats -r ../output_fe/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_na/stats -r ../output_na/bondlength.withC.txt &

## The above should use -bondLength option
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -r ../output_zn/r.allLig.txt -rf ../output_zn/rf.smallest.txt -s a s ../output_zn/seqs.ATOM.shell.txt -s s s ../output_zn/seqs.SEQRES.shell.txt -s s b ../output_zn/seqs.SEQRES.bind.txt -bondLength ../output_zn/bondlength.noC.txt; date

date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -s a s ../output_mg/seqs.ATOM.shell.txt -s s s ../output_mg/seqs.SEQRES.shell.txt -s s b ../output_mg/seqs.SEQRES.bind.txt -rf ../output_mg/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -r ../output_ca/r.allLig.txt -s a s ../output_ca/seqs.ATOM.shell.txt -s s s ../output_ca/seqs.SEQRES.shell.txt -s s b ../output_ca/seqs.SEQRES.bind.txt -rf ../output_ca/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.638 SON -dd ../output_fe/stats.r -r ../output_fe/r.allLig.txt -s a s ../output_fe/seqs.ATOM.shell.txt -s s s ../output_fe/seqs.SEQRES.shell.txt -s s b ../output_fe/seqs.SEQRES.bind.txt -rf ../output_fe/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt -rf ../output_na/rf.smallest.txt; date

## 4.14, fixed an error in selecting ligands at the -dd step, it could affect both -rf and -sb
mv ../output_ca/seqs.SEQRES.bind.txt ../output_ca/seqs.SEQRES.bind.old.txt ## to compare with the new one
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -rf ../output_zn/rf.smallest.txt -s s b ../output_zn/seqs.SEQRES.bind.txt ; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -rf ../output_ca/rf.smallest.txt -s s b ../output_ca/seqs.SEQRES.bind.txt ; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.638 SON -dd ../output_fe/stats.r -s s b ../output_fe/seqs.SEQRES.bind.txt -rf ../output_fe/rf.smallest.txt; date
## Problem fixed!

## rerun all options
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -r ../output_zn/r.allLig.txt -rf ../output_zn/rf.smallest.txt -s a s ../output_zn/seqs.ATOM.shell.txt -s s s ../output_zn/seqs.SEQRES.shell.txt -s s b ../output_zn/seqs.SEQRES.bind.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt -rf ../output_na/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -s a s ../output_mg/seqs.ATOM.shell.txt -s s s ../output_mg/seqs.SEQRES.shell.txt -s s b ../output_mg/seqs.SEQRES.bind.txt -rf ../output_mg/rf.smallest.txt; date

## Zn: 5h. Na: 9.5h.
## 4.16, rerun Ca and Fe
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -r ../output_ca/r.allLig.txt -s a s ../output_ca/seqs.ATOM.shell.txt -s s s ../output_ca/seqs.SEQRES.shell.txt -s s b ../output_ca/seqs.SEQRES.bind.txt -rf ../output_ca/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.638 SON -dd ../output_fe/stats.r -r ../output_fe/r.allLig.txt -s a s ../output_fe/seqs.ATOM.shell.txt -s s s ../output_fe/seqs.SEQRES.shell.txt -s s b ../output_fe/seqs.SEQRES.bind.txt -rf ../output_fe/rf.smallest.txt; date

## Ca: 5h. Fe: 5h.

