##!/usr/bash

## for each of the metal in Zn Mg Ca Fe Na, show only one as example

## Test run for just bootstrapping, comment out the rest, and print out angle distribution 
./znCoordinations.pl ../metalloproteins/protein_list_Zn.txt Zn -d ../output_allMetal/stats.Zn -angleBD ../output_allMetal/angleDist.Zn.txt

## Put in the "vote" binding ligands via chi-squared stat, add in a 7-ligand CG temporarily, and print out probs for each coordination number (CN).
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bind.Na -angleBD ../output_allMetal/angleDist.bind.Na.txt >../output_allMetal/numLigProb.Na.txt; date

#Thu Jul 30 22:06:04 EDT 2015
#Fri Jul 31 03:18:14 EDT 2015

#date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bind.Fe -angleBD ../output_allMetal/angleDist.bind.Fe.txt > ../output_allMetal/numLigProb.Fe.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bind.Ca -angleBD ../output_allMetal/angleDist.bind.Ca.txt > ../output_allMetal/numLigProb.Ca.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bind.Mg -angleBD ../output_allMetal/angleDist.bind.Mg.txt > ../output_allMetal/numLigProb.Mg.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bind.Zn -angleBD ../output_allMetal/angleDist.bind.Zn.txt > ../output_allMetal/numLigProb.Zn.txt; date 
#Thu Jul 30 22:28:35 EDT 2015
#Fri Jul 31 00:23:26 EDT 2015
#Fri Jul 31 02:11:48 EDT 2015
#Fri Jul 31 16:21:32 EDT 2015
#Fri Jul 31 17:48:31 EDT 2015


## Run the prob up to 10-ligand, rename the above to ligNumProb.Zn.7.txt
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bind.Na -angleBD ../output_allMetal/angleDist.bind.Na.txt >../output_allMetal/ligNumProb.Na.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bind.Fe -angleBD ../output_allMetal/angleDist.bind.Fe.txt > ../output_allMetal/ligNumProb.Fe.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bind.Ca -angleBD ../output_allMetal/angleDist.bind.Ca.txt > ../output_allMetal/ligNumProb.Ca.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bind.Zn -angleBD ../output_allMetal/angleDist.bind.Zn.txt > ../output_allMetal/ligNumProb.Zn.txt; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bind.Mg -angleBD ../output_allMetal/angleDist.bind.Mg.txt > ../output_allMetal/ligNumProb.Mg.txt; date

Sat Aug  1 11:18:10 EDT 2015
Sat Aug  1 16:32:45 EDT 2015
Sat Aug  1 18:30:28 EDT 2015
Sat Aug  1 20:30:13 EDT 2015
Sat Aug  1 22:01:13 EDT 2015
Sun Aug  2 12:14:43 EDT 2015

## Try bootstrap with Tet, Tbp, Oct, and add Spy (and maybe pbp)
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.spy.Zn; date

## Add Pentagonal Bipyramidal in bootstrap 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.pbp.Zn; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.pbp.Ca; date

#Wed Aug  5 23:19:30 EDT 2015
#Deviation sorted: #Octahedral = 974 #PentagonalBipyramidal = 29 #Tetrahedral = 18039 #TrigonalBipyramidal = 2553
#Thu Aug  6 00:46:51 EDT 2015
#Deviation sorted: #Octahedral = 5899 #PentagonalBipyramidal = 4138 #Tetrahedral = 5036 #TrigonalBipyramidal = 6543
#Thu Aug  6 03:31:55 EDT 2015

## removed all metal-metal cluster
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bootstrap.Zn; date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bootstrap.Ca; date

#Thu Aug  6 15:50:53 EDT 2015
#Deviation sorted: Octahedral = 975 PentagonalBipyramidal = 28 Tetrahedral = 18036 TrigonalBipyramidal = 2556
#Thu Aug  6 17:17:40 EDT 2015
#Deviation sorted: Octahedral = 5893 PentagonalBipyramidal = 4136 Tetrahedral = 5023 TrigonalBipyramidal = 6556
#Thu Aug  6 19:52:11 EDT 2015

date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bootstrap.Fe; date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bootstrap.Na; date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bootstrap.Mg; date

#Thu Aug  6 23:24:15 EDT 2015
#Deviation sorted: Octahedral = 8630 PentagonalBipyramidal = 57 Tetrahedral = 2202 TrigonalBipyramidal = 4803
#Fri Aug  7 01:22:07 EDT 2015
#Deviation sorted: Octahedral = 2212 PentagonalBipyramidal = 208 Tetrahedral = 6046 TrigonalBipyramidal = 4376
#Fri Aug  7 06:45:14 EDT 2015
#Deviation sorted: Octahedral = 12814 PentagonalBipyramidal = 353 Tetrahedral = 10952 TrigonalBipyramidal = 10318
#Fri Aug  7 20:53:57 EDT 2015

## Add spy in bootstrap to only 5-lig shells
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.spy.Fe; date

#Fri Aug  7 12:20:48 EDT 2015 
#Deviation sorted: Octahedral = 8630 PentagonalBipyramidal = 57 SquarePyramidal = 3192 Tetrahedral = 2157 TrigonalBipyramidal = 1656
#Fri Aug  7 14:20:16 EDT 2015

## print out bond length to visualize.
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.Na.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.Zn.txt; date; 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.Ca.txt; date; 
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.Fe.txt; date;
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.Mg.txt; date;

## Same as bootstrap

## The above was actually printing out bond-length after ligand chosing, not bootstrapping. So re-run
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.bs.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.bs.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.bs.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.bs.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.bs.Mg.txt &

## Add r value and r free along with bond length, make bootstrap a workflow choice
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.bl.Zn -bondLength ../output_allMetal/bondLength.rvalue.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.bl.Na -bondLength ../output_allMetal/bondLength.rvalue.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.bl.Ca -bondLength ../output_allMetal/bondLength.rvalue.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.bl.Fe -bondLength ../output_allMetal/bondLength.rvalue.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.bl.Mg -bondLength ../output_allMetal/bondLength.rvalue.Mg.txt &

## The bootstrapping may include 2nd shell atoms because a generous distance cutoff. So remove the 2nd shell by checking is there any atoms in between.
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.rm2ndshell.Na -bondLength ../output_allMetal/bondLength.rm2ndshell.Na.txt >../output_allMetal/output.rm2ndshell.Na.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.rm2ndshell.Ca -bondLength ../output_allMetal/bondLength.rm2ndshell.Ca.txt >../output_allMetal/output.rm2ndshell.Ca.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.rm2ndshell.Fe -bondLength ../output_allMetal/bondLength.rm2ndshell.Fe.txt >../output_allMetal/output.rm2ndshell.Fe.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.rm2ndshell.Zn -bondLength ../output_allMetal/bondLength.rm2ndshell.Zn.txt >../output_allMetal/output.rm2ndshell.Zn.txt &
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.rm2ndshell.Mg -bondLength ../output_allMetal/bondLength.rm2ndshell.Mg.txt >../output_allMetal/output.rm2ndshell.Mg.txt &

## Throw carbon in to see what happens
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.carbon.Na -bondLength ../output_allMetal/bondLength.carbon.Na.txt >../output_allMetal/output.carbon.Na.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.carbon.Ca -bondLength ../output_allMetal/bondLength.carbon.Ca.txt >../output_allMetal/output.carbon.Ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.carbon.Fe -bondLength ../output_allMetal/bondLength.carbon.Fe.txt >../output_allMetal/output.carbon.Fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.carbon.Zn -bondLength ../output_allMetal/bondLength.carbon.Zn.txt >../output_allMetal/output.carbon.Zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.carbon.Mg -bondLength ../output_allMetal/bondLength.carbon.Mg.txt >../output_allMetal/output.carbon.Mg.txt &

## Had a mistake in including the carbons, need rerun
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_allMetal/stats.carbon1.Na -bondLength ../output_allMetal/bondLength.carbon1.Na.txt >../output_allMetal/output.carbon1.Na.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_allMetal/stats.carbon1.Ca -bondLength ../output_allMetal/bondLength.carbon1.Ca.txt >../output_allMetal/output.carbon1.Ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_allMetal/stats.carbon1.Fe -bondLength ../output_allMetal/bondLength.carbon1.Fe.txt >../output_allMetal/output.carbon1.Fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_allMetal/stats.carbon1.Zn -bondLength ../output_allMetal/bondLength.carbon1.Zn.txt >../output_allMetal/output.carbon1.Zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_allMetal/stats.carbon1.Mg -bondLength ../output_allMetal/bondLength.carbon1.Mg.txt >../output_allMetal/output.carbon1.Mg.txt &


## get first shell cutoff and ligand element passed in as parameters
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs shellCutoff 3.302 ON ../output_allMetal/stats.cutoff.Na -bondLength ../output_allMetal/bondLength.cutoff.Na.txt >../output_allMetal/output.cutoff.Na.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs shellCutoff 3.094 O ../output_allMetal/stats.cutoff.Ca -bondLength ../output_allMetal/bondLength.cutoff.Ca.txt >../output_allMetal/output.cutoff.Ca.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs shellCutoff 2.640 SON ../output_allMetal/stats.cutoff.Fe -bondLength ../output_allMetal/bondLength.cutoff.Fe.txt >../output_allMetal/output.cutoff.Fe.txt& 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs shellCutoff 2.783 SON ../output_allMetal/stats.cutoff.Zn -bondLength ../output_allMetal/bondLength.cutoff.Zn.txt >../output_allMetal/output.cutoff.Zn.txt&
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs shellCutoff 2.856 ON ../output_allMetal/stats.cutoff.Mg -bondLength ../output_allMetal/bondLength.cutoff.Mg.txt >../output_allMetal/output.cutoff.Mg.txt&

## test run on zn to compare the difference between single ligand voting and all-ligand chi squared test.
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.singleLig.Zn -bondLength ../output_allMetal/bondLength.singleLig.Zn.txt >../output_allMetal/output.singleLig.Zn.txt
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig.Zn -bondLength ../output_allMetal/bondLength.chiSquaredLig.Zn.txt >../output_allMetal/output.chiSquaredLig.Zn.txt

## Rerun to have R input for testing the angle space 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig1.Zn -bondLength ../output_allMetal/bondLength.singleLig1.Zn.txt -r ../output_allMetal/rAllLig.singleLig.txt >../output_allMetal/output.tooClose.Zn.txt
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig1.Zn -bondLength ../output_allMetal/bondLength.chiSquaredLig1.Zn.txt -r ../output_allMetal/rAllLig.chiSquaredLig.txt

## Generate sequences
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.ss.singleLig.Zn -s s s ../output_allMetal/seqs.SEQRES.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.as.singleLig.Zn -s a s ../output_allMetal/seqs.ATOM.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.sb.singleLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.singleLig.zn.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.ss.chiSquaredLig.Zn -s s s ../output_allMetal/seqs.SEQRES.shell.chiSquaredLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.as.chiSquaredLig.Zn -s a s ../output_allMetal/seqs.ATOM.shell.chiSquaredLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.sb.chiSquaredLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.chiSquaredLig.zn.txt &

## 10.15, change the input and output file accordingly for singleLig and chiSquaredLig
./seq_alignment.R

## 10.16, removed 3-ligand inclusion?
./nonRedundancy.R

## 11.2, rerun to get R input after fixing &orderedAngles
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig2.Zn -r ../output_allMetal/rAllLig.singleLig.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig2.Zn -r ../output_allMetal/rAllLig.chiSquaredLig.txt &

## 11.30 remove 3-ligand sites from printing for singleLig
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.ss.singleLig.Zn -s s s ../output_allMetal/seqs.SEQRES.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.as.singleLig.Zn -s a s ../output_allMetal/seqs.ATOM.shell.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.sb.singleLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.singleLig.zn.txt &

## rerun SEQRES.bind.chiSquaredLig to see why is it different for bind and shell seq 
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.sb.chiSquaredLig.Zn -s s b ../output_allMetal/seqs.SEQRES.bind.chiSquaredLig.zn.txt >../output_allMetal/out.noProtLig.txt

## 12.1 run down to non redundancy for singleLig and chiSquaredLig
./seq_alignment.R; ./nonRedundancy.R

## 12.3 get the smallest angle spreadsheet for rf input, and add number of ligands, method, year, and resolution columns
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig.rf.Zn -rf ../output_allMetal/rf.singleLig.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig.rf.Zn -rf ../output_allMetal/rf.chiSquaredLig.txt &

## 12.4 rerun to get R spreadsheet again with a new format: all angles are in one single column and need to be split in R
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_allMetal/stats.singleLig3.Zn -r ../output_allMetal/rAllLig.singleLig.zn.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -d shellCutoff 2.783 SON ../output_allMetal/stats.chiSquaredLig3.Zn -r ../output_allMetal/rAllLig.chiSquaredLig.zn.txt &

## 12.9 change the kmeans format to handle all angles in one column, and change the code manully to switch between singleLig/chiSquaredLig and 5/6 angle space: run 4 times done.
./kmeans.mnr.optimalk.R

## make the directory an argument to pass in on command line in R
./write_fasta.R ../output_allMetal/

## run interproscan accordingly, _f22 on Hypnos doesn't work again. Ran on hemera vm
/mlab/data/software/interproscan/interproscan.sh -i ../output_allMetal/non_redundant_zinc.singleLig.zn.fa -f tsv -iprlookup -pa -goterms -o ../output_allMetal/non_redundant_zinc.singleLig.zn.ipr.tsv
/mlab/data/software/interproscan/interproscan.sh -i ../output_allMetal/non_redundant_zinc.chiSquaredLig.zn.fa -f tsv -iprlookup -pa -goterms -o ../output_allMetal/non_redundant_zinc.chiSquaredLig.zn.ipr.tsv

## functional_characterization.R, make the directory an argument to pass in on command line.
./functional_characterization.R ../output_allMetal/

## proceed with measures and graphs.
./measures.vs.k.R ../output_allMetal/
./cluster_metric_graphs.R ../output_allMetal/

## 12.10, fix the measures*.R only used 5 angle space for all calculation. rerun single6 and chisqr6
./measures.vs.k.R ../output_allMetal/
./cluster_metric_graphs.R ../output_allMetal/

## change the kmeans to take command line argument, make 5/6 angle space an option as well, and change rep to 500
./kmeans.mnr.optimalk.R ../output_single5 5; ./kmeans.mnr.optimalk.R ../output_single6 6
./kmeans.mnr.optimalk.R ../output_chiSquared5 5; ./kmeans.mnr.optimalk.R ../output_chiSquared6 6

## 12.11, continue with functional analysis
./functional_characterization.R ../output_chiSquared5 && ./functional_characterization.R ../output_chiSquared6
./functional_characterization.R ../output_single5 && ./functional_characterization.R ../output_single6

## 
./measures.vs.k.R ../output_single5 5 && ./measures.vs.k.R ../output_single6 6

## 12.12
./measures.vs.k.R ../output_chiSquared5 5 && ./measures.vs.k.R ../output_chiSquared6 6

./cluster_metric_graphs.R ../output_single5
./cluster_metric_graphs.R ../output_single6
./cluster_metric_graphs.R ../output_chiSquared5
./cluster_metric_graphs.R ../output_chiSquared6

## 12.15 make the directory, angle space, num of norm, comp, comb clusters as arguements
./cluster.centers.prob.R ../output_chiSquared6/ 6 7 6 12 | less

## rerun to test 2.5 std single ligand selection criteria, get diff result files at the same time
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single/stats.zn -s s s ../output_2.5single/seqs.SEQRES.shell.txt -s a s ../output_2.5single/seqs.ATOM.shell.txt -s s b ../output_2.5single/seqs.SEQRES.bind.txt -r ../output_2.5single/r.allLig.txt -rf ../output_2.5single/rf.smallest.txt

## 12.16 sequence options are exclusive, the above only got sb opt run, has to run separately
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single/stats.ss -s s s ../output_2.5single/seqs.SEQRES.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single/stats.as -s a s ../output_2.5single/seqs.ATOM.shell.txt &

## test 2 std single ligand selection criteria, get diff result files at the same time
## never do this again!
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.ss -s s s ../output_2single/seqs.SEQRES.shell.txt -r ../output_2single/r.allLig.txt -rf ../output_2single/rf.smallest.txt &
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.as -s a s ../output_2single/seqs.SEQRES.shell.txt &
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.sb -s s b ../output_2single/seqs.ATOM.shell.txt &

## the names of the above seq results are wrong, rename the later two and rerun to get ss
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.ss -s s s ../output_2single/seqs.SEQRES.shell.txt &

## proceed with everything
./seq_alignment.R ../output_2.5single/
./nonRedundancy.R ../output_2.5single/
./rf.smallAngle.R ../output_2.5single/

## make a copy of the output_2.5single folder
./kmeans.mnr.optimalk.R ../output_2.5single5 5
./kmeans.mnr.optimalk.R ../output_2.5single6 6

## Actually the seq files are cancatenate to exsisting ones, then proceed same thing with output_2single
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.ss -s s s ../output_2single/seqs.SEQRES.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.as -s a s ../output_2single/seqs.ATOM.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2single/stats.sb -s s b ../output_2single/seqs.SEQRES.bind.txt &
./seq_alignment.R ../output_2single/ && ./nonRedundancy.R ../output_2single/ && ./rf.smallAngle.R ../output_2single/

./kmeans.mnr.optimalk.R ../output_2single5 5
./kmeans.mnr.optimalk.R ../output_2single6 6

## 12.17 
./write_fasta.R ../output_2single5
./write_fasta.R ../output_2single6
./write_fasta.R ../output_2.5single5
./write_fasta.R ../output_2.5single6

## ssh interproscan
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single6
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single6
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## All of the above four failed!

## start other metals
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.ss -s s s ../output_Na_chiSquared/seqs.SEQRES.shell.txt -r ../output_Na_chiSquared/r.allLig.txt -rf ../output_Na_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.ss -s s s ../output_Na_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.ss -s s b ../output_Na_chiSquared/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.ss -s s s ../output_Ca_chiSquared/seqs.SEQRES.shell.txt -r ../output_Ca_chiSquared/r.allLig.txt -rf ../output_Ca_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.ss -s s s ../output_Ca_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.ss -s s b ../output_Ca_chiSquared/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.ss -s s s ../output_Fe_chiSquared/seqs.SEQRES.shell.txt -r ../output_Fe_chiSquared/r.allLig.txt -rf ../output_Fe_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.ss -s s s ../output_Fe_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.ss -s s b ../output_Fe_chiSquared/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.ss -s s s ../output_Mg_chiSquared/seqs.SEQRES.shell.txt -r ../output_Mg_chiSquared/r.allLig.txt -rf ../output_Mg_chiSquared/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.ss -s s s ../output_Mg_chiSquared/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.ss -s s b ../output_Mg_chiSquared/seqs.SEQRES.bind.txt &


## 12.18 Try to rerun interproscan, 5 and 6 angle space do not affect the functional mapping, so only need to once
## on hemera fedora20@vm
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single5
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## on interproscan vm
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## The -s a s option actually didn't get running from above, need rerun
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -d shellCutoff 3.302 ON ../output_Na_chiSquared/stats.as -s a s ../output_Na_chiSquared/seqs.ATOM.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -d shellCutoff 3.094 O ../output_Ca_chiSquared/stats.as -s a s ../output_Ca_chiSquared/seqs.ATOM.shell.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -d shellCutoff 2.640 SON ../output_Fe_chiSquared/stats.as -s a s ../output_Fe_chiSquared/seqs.ATOM.shell.txt & 
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -d shellCutoff 2.856 ON ../output_Mg_chiSquared/stats.as -s a s ../output_Mg_chiSquared/seqs.ATOM.shell.txt &

## Use 3 std for now to run single ligand selection on other metals
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.ss -s s s ../output_Na_singleLig/seqs.SEQRES.shell.txt -r ../output_Na_singleLig/r.allLig.txt -rf ../output_Na_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.as -s a s ../output_Na_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.sb -s s b ../output_Na_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.ss -s s s ../output_Ca_singleLig/seqs.SEQRES.shell.txt -r ../output_Ca_singleLig/r.allLig.txt -rf ../output_Ca_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.as -s a s ../output_Ca_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.sb -s s b ../output_Ca_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.ss -s s s ../output_Fe_singleLig/seqs.SEQRES.shell.txt -r ../output_Fe_singleLig/r.allLig.txt -rf ../output_Fe_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.as -s a s ../output_Fe_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.sb -s s b ../output_Fe_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.ss -s s s ../output_Mg_singleLig/seqs.SEQRES.shell.txt -r ../output_Mg_singleLig/r.allLig.txt -rf ../output_Mg_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.as -s a s ../output_Mg_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.sb -s s b ../output_Mg_singleLig/seqs.SEQRES.bind.txt &

## 12.19, the one run on interproscan VM was failed again, don't know if it's because background Mg running was messing it up
## on hemera fedora20@vm
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2.5single5
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## on interproscan vm (screen 8)
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_2single6
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
## hemera vm worked, and interproscan vm failed
## set up screen 8 to be hemera vm

## 12.20, finish running 2std and 3std on zinc
./functional_characterization.R ../output_2.5single5
./measures.vs.k.R ../output_2.5single5 5
./cluster_metric_graphs.R ../output_2.5single5

./functional_characterization.R ../output_2.5single6 && ./measures.vs.k.R ../output_2.5single6 6 && ./cluster_metric_graphs.R ../output_2.5single6 &
./functional_characterization.R ../output_2single5 && ./measures.vs.k.R ../output_2single5 5 && ./cluster_metric_graphs.R ../output_2single5 &
./functional_characterization.R ../output_2single6 && ./measures.vs.k.R ../output_2single6 6 && ./cluster_metric_graphs.R ../output_2single6 &

## Ca, Na, Fe, Mg
./seq_alignment.R ../output_Ca_singleLig
./nonRedundancy.R ../output_Ca_singleLig 
./write_fasta.R ../output_Ca_singleLig 
./seq_alignment.R ../output_Ca_chiSquared && ./nonRedundancy.R ../output_Ca_chiSquared && ./write_fasta.R ../output_Ca_chiSquared 

./seq_alignment.R ../output_Na_singleLig && ./nonRedundancy.R ../output_Na_singleLig && ./write_fasta.R ../output_Na_singleLig 
./seq_alignment.R ../output_Na_chiSquared && ./nonRedundancy.R ../output_Na_chiSquared && ./write_fasta.R ../output_Na_chiSquared 

./seq_alignment.R ../output_Mg_singleLig && ./nonRedundancy.R ../output_Mg_singleLig && ./write_fasta.R ../output_Mg_singleLig 
./seq_alignment.R ../output_Mg_chiSquared && ./nonRedundancy.R ../output_Mg_chiSquared && ./write_fasta.R ../output_Mg_chiSquared 

./seq_alignment.R ../output_Fe_singleLig && ./nonRedundancy.R ../output_Fe_singleLig && ./write_fasta.R ../output_Fe_singleLig 
./seq_alignment.R ../output_Fe_chiSquared && ./nonRedundancy.R ../output_Fe_chiSquared && ./write_fasta.R ../output_Fe_chiSquared 


## interproscan once write_fasta.R done running
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Ca_chiSquared
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 12.21, do chiSquared first, before # of std is decided
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Na_chiSquared
/mlab/data/software/interproscan/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## try different angle space reduction on zinc with 3 std
./kmeans.mnr.optimalk.R ../output_single3 3 && ./kmeans.mnr.optimalk.R ../output_single4 4

## 12.22
./functional_characterization.R ../output_single3 && ./functional_characterization.R ../output_single4 &&./measures.vs.k.R ../output_single3 3 && ./measures.vs.k.R ../output_single4 4 && ./cluster_metric_graphs.R ../output_single3 && ./cluster_metric_graphs.R ../output_single4


## The interproscan VM is good now
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Fe_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Mg_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 12.27 run the metals again with 2.5 std for single
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.ss -s s s ../output_Na_singleLig/seqs.SEQRES.shell.txt -r ../output_Na_singleLig/r.allLig.txt -rf ../output_Na_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.as -s a s ../output_Na_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats.sb -s s b ../output_Na_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.ss -s s s ../output_Ca_singleLig/seqs.SEQRES.shell.txt -r ../output_Ca_singleLig/r.allLig.txt -rf ../output_Ca_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.as -s a s ../output_Ca_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats.sb -s s b ../output_Ca_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.ss -s s s ../output_Fe_singleLig/seqs.SEQRES.shell.txt -r ../output_Fe_singleLig/r.allLig.txt -rf ../output_Fe_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.as -s a s ../output_Fe_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats.sb -s s b ../output_Fe_singleLig/seqs.SEQRES.bind.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.ss -s s s ../output_Mg_singleLig/seqs.SEQRES.shell.txt -r ../output_Mg_singleLig/r.allLig.txt -rf ../output_Mg_singleLig/rf.smallest.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.as -s a s ../output_Mg_singleLig/seqs.ATOM.shell.txt && ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats.sb -s s b ../output_Mg_singleLig/seqs.SEQRES.bind.txt &


## 12.28 added the bond lengths of smallest angle ligands to -rf opt output
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -dd shellCutoff 2.856 ON ../output_Mg_singleLig/stats -rf ../output_Mg_singleLig/rf.smallest.mg.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -dd shellCutoff 3.094 O ../output_Ca_singleLig/stats -rf ../output_Ca_singleLig/rf.smallest.ca.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -dd shellCutoff 2.640 SON ../output_Fe_singleLig/stats -rf ../output_Fe_singleLig/rf.smallest.fe.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -dd shellCutoff 3.302 ON ../output_Na_singleLig/stats -rf ../output_Na_singleLig/rf.smallest.na.txt &

## Try above with Zn
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -dd shellCutoff 2.783 SON ../output_2.5single5/stats -rf ../output_2.5single5/rf.smallest.zn.txt &

./seq_alignment.R ../output_Ca_singleLig && ./nonRedundancy.R ../output_Ca_singleLig && ./write_fasta.R ../output_Ca_singleLig
./seq_alignment.R ../output_Fe_singleLig && ./nonRedundancy.R ../output_Fe_singleLig && ./write_fasta.R ../output_Fe_singleLig
./seq_alignment.R ../output_Na_singleLig && ./nonRedundancy.R ../output_Na_singleLig && ./write_fasta.R ../output_Na_singleLig
./seq_alignment.R ../output_Mg_singleLig 
./nonRedundancy.R ../output_Mg_singleLig && ./write_fasta.R ../output_Mg_singleLig

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Ca_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Fe_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Na_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 12.29, rename the output_2.5single5 to output_Zn_singleLig5
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Zn_singleLig5
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Mg_singleLig
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## redo the Ca and Na chiSquared because they were using the 5.15 interproscan on hemera fedora20VM
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Ca_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_Na_chiSquared
/mlab/data/software/interproscan/interproscan_f22.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 2016.1.3, Try the bi-aa criteria to separate the data into normal and compressed baesed on the average bondlength vs. smallest angles group
./rf.biaa.R ../output_Zn_biaa5
./rf.biaa.R ../output_Zn_biaa6
./kmeans.mnr.optimalk.R ../output_Zn_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Zn_biaa6 6
./kmeans.mnr.optimalk.R ../output_Zn_biaa3 3 && ./kmeans.mnr.optimalk.R ../output_Zn_biaa4 4

## 1.4, 
./functional_characterization.R ../output_Zn_biaa6 && ./measures.vs.k.R ../output_Zn_biaa6 6 && ./cluster_metric_graphs.R ../output_Zn_biaa6 
./functional_characterization.R ../output_Zn_biaa5 && ./measures.vs.k.R ../output_Zn_biaa5 5 && ./cluster_metric_graphs.R ../output_Zn_biaa5 
./functional_characterization.R ../output_Zn_biaa4 && ./measures.vs.k.R ../output_Zn_biaa4 4 && ./cluster_metric_graphs.R ../output_Zn_biaa4 
./functional_characterization.R ../output_Zn_biaa3 && ./measures.vs.k.R ../output_Zn_biaa3 3 && ./cluster_metric_graphs.R ../output_Zn_biaa3 


## 1.5, proceed with other metals, and try RF separation and bi-aa separation
./rf.smallAngle.R ../output_Ca_singleLig 55 65
./rf.smallAngle.R ../output_Na_singleLig 45 60
./rf.smallAngle.R ../output_Mg_singleLig 52 68
./rf.smallAngle.R ../output_Fe_singleLig 63 73

./rf.biaa.R ../output_Ca_biaa6
./rf.biaa.R ../output_Na_biaa3
./rf.biaa.R ../output_Mg_biaa6


## duplicate each folder
./kmeans.mnr.optimalk.R ../output_Ca_single5 5 && ./kmeans.mnr.optimalk.R ../output_Ca_single6 6 && ./kmeans.mnr.optimalk.R ../output_Ca_single3 3 && ./kmeans.mnr.optimalk.R ../output_Ca_single4 4

./kmeans.mnr.optimalk.R ../output_Na_single5 5 
./kmeans.mnr.optimalk.R ../output_Na_single6 6 && ./kmeans.mnr.optimalk.R ../output_Na_single4 4 && ./kmeans.mnr.optimalk.R ../output_Na_single3 3

./kmeans.mnr.optimalk.R ../output_Mg_single5 5 
./kmeans.mnr.optimalk.R ../output_Mg_single6 6 
./kmeans.mnr.optimalk.R ../output_Mg_single3 3 
./kmeans.mnr.optimalk.R ../output_Mg_single4 4

./kmeans.mnr.optimalk.R ../output_Fe_single5 5 && ./kmeans.mnr.optimalk.R ../output_Fe_single6 6 && ./kmeans.mnr.optimalk.R ../output_Fe_single4 4 && ./kmeans.mnr.optimalk.R ../output_Fe_single3 3

## bi-aa
./kmeans.mnr.optimalk.R ../output_Ca_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Ca_biaa6 6 
./kmeans.mnr.optimalk.R ../output_Ca_biaa3 3 && ./kmeans.mnr.optimalk.R ../output_Ca_biaa4 4

./kmeans.mnr.optimalk.R ../output_Na_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Na_biaa6 6  
./kmeans.mnr.optimalk.R ../output_Na_biaa4 4 && ./kmeans.mnr.optimalk.R ../output_Na_biaa3 3

./kmeans.mnr.optimalk.R ../output_Mg_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Mg_biaa6 6 && ./kmeans.mnr.optimalk.R ../output_Mg_biaa3 3 && ./kmeans.mnr.optimalk.R ../output_Mg_biaa4 4

./kmeans.mnr.optimalk.R ../output_Fe_biaa5 5 && ./kmeans.mnr.optimalk.R ../output_Fe_biaa6 6 
./kmeans.mnr.optimalk.R ../output_Fe_biaa4 4  
./kmeans.mnr.optimalk.R ../output_Fe_biaa3 3

## 1.6, finish runing everthing, single/biaa & 3/4/5/6
## ./functional_characterization.R ../output_Mg_single6 && ./measures.vs.k.R ../output_Mg_single6 6 && ./cluster_metric_graphs.R ../output_Mg_single6
./functional_characterization.R ../output_Mg_single5 && ./measures.vs.k.R ../output_Mg_single5 5 && ./cluster_metric_graphs.R ../output_Mg_single5
./functional_characterization.R ../output_Mg_single4 && ./measures.vs.k.R ../output_Mg_single4 4 && ./cluster_metric_graphs.R ../output_Mg_single4
./functional_characterization.R ../output_Mg_single3 && ./measures.vs.k.R ../output_Mg_single3 3 && ./cluster_metric_graphs.R ../output_Mg_single3

date; ./functional_characterization.R ../output_Mg_biaa6 && date; ./measures.vs.k.R ../output_Mg_biaa6 6 && ./cluster_metric_graphs.R ../output_Mg_biaa6
./functional_characterization.R ../output_Mg_biaa5 && ./measures.vs.k.R ../output_Mg_biaa5 5 && ./cluster_metric_graphs.R ../output_Mg_biaa5
./functional_characterization.R ../output_Mg_biaa4 && ./measures.vs.k.R ../output_Mg_biaa4 4 && ./cluster_metric_graphs.R ../output_Mg_biaa4
./functional_characterization.R ../output_Mg_biaa3 && ./measures.vs.k.R ../output_Mg_biaa3 3 && ./cluster_metric_graphs.R ../output_Mg_biaa3

./functional_characterization.R ../output_Ca_single6 && ./measures.vs.k.R ../output_Ca_single6 6 && ./cluster_metric_graphs.R ../output_Ca_single6
./functional_characterization.R ../output_Ca_single5 && ./measures.vs.k.R ../output_Ca_single5 5 && ./cluster_metric_graphs.R ../output_Ca_single5
./functional_characterization.R ../output_Ca_single4 && ./measures.vs.k.R ../output_Ca_single4 4 && ./cluster_metric_graphs.R ../output_Ca_single4
./functional_characterization.R ../output_Ca_single3 && ./measures.vs.k.R ../output_Ca_single3 3 && ./cluster_metric_graphs.R ../output_Ca_single3

./functional_characterization.R ../output_Ca_biaa6 && ./measures.vs.k.R ../output_Ca_biaa6 6 && ./cluster_metric_graphs.R ../output_Ca_biaa6
./functional_characterization.R ../output_Ca_biaa5 && ./measures.vs.k.R ../output_Ca_biaa5 5 && ./cluster_metric_graphs.R ../output_Ca_biaa5
./functional_characterization.R ../output_Ca_biaa4 && ./measures.vs.k.R ../output_Ca_biaa4 4 && ./cluster_metric_graphs.R ../output_Ca_biaa4
./functional_characterization.R ../output_Ca_biaa3 && ./measures.vs.k.R ../output_Ca_biaa3 3 && ./cluster_metric_graphs.R ../output_Ca_biaa3

./functional_characterization.R ../output_Fe_single6 && ./measures.vs.k.R ../output_Fe_single6 6 && ./cluster_metric_graphs.R ../output_Fe_single6
./functional_characterization.R ../output_Fe_single5 && ./measures.vs.k.R ../output_Fe_single5 5 && ./cluster_metric_graphs.R ../output_Fe_single5
./functional_characterization.R ../output_Fe_single4 && ./measures.vs.k.R ../output_Fe_single4 4 && ./cluster_metric_graphs.R ../output_Fe_single4
./functional_characterization.R ../output_Fe_single3 && ./measures.vs.k.R ../output_Fe_single3 3 && ./cluster_metric_graphs.R ../output_Fe_single3

./functional_characterization.R ../output_Fe_biaa6 && ./measures.vs.k.R ../output_Fe_biaa6 6 && ./cluster_metric_graphs.R ../output_Fe_biaa6
./functional_characterization.R ../output_Fe_biaa5 && ./measures.vs.k.R ../output_Fe_biaa5 5 && ./cluster_metric_graphs.R ../output_Fe_biaa5
./functional_characterization.R ../output_Fe_biaa4 && ./measures.vs.k.R ../output_Fe_biaa4 4 && ./cluster_metric_graphs.R ../output_Fe_biaa4
./functional_characterization.R ../output_Fe_biaa3 && ./measures.vs.k.R ../output_Fe_biaa3 3 && ./cluster_metric_graphs.R ../output_Fe_biaa3

./functional_characterization.R ../output_Na_single6 && ./measures.vs.k.R ../output_Na_single6 6 && ./cluster_metric_graphs.R ../output_Na_single6
./functional_characterization.R ../output_Na_single5 && ./measures.vs.k.R ../output_Na_single5 5 && ./cluster_metric_graphs.R ../output_Na_single5
./functional_characterization.R ../output_Na_single4 && ./measures.vs.k.R ../output_Na_single4 4 && ./cluster_metric_graphs.R ../output_Na_single4
./functional_characterization.R ../output_Na_single3 && ./measures.vs.k.R ../output_Na_single3 3 && ./cluster_metric_graphs.R ../output_Na_single3

./functional_characterization.R ../output_Na_biaa6 && ./measures.vs.k.R ../output_Na_biaa6 6 && ./cluster_metric_graphs.R ../output_Na_biaa6
./functional_characterization.R ../output_Na_biaa5 && ./measures.vs.k.R ../output_Na_biaa5 5 && ./cluster_metric_graphs.R ../output_Na_biaa5
./functional_characterization.R ../output_Na_biaa4 && ./measures.vs.k.R ../output_Na_biaa4 4 && ./cluster_metric_graphs.R ../output_Na_biaa4
./functional_characterization.R ../output_Na_biaa3 && ./measures.vs.k.R ../output_Na_biaa3 3 && ./cluster_metric_graphs.R ../output_Na_biaa3


## 1.8, after corrected angles
./kmeans.mnr.optimalk.R ../Mg_results/biaa5_correctedangle 5 && ./kmeans.mnr.optimalk.R ../Mg_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/biaa6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/biaa5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Na_results/biaa6_correctedangle 6

## 1.9
nice -10 ./functional_characterization.R ../Zn_results/biaa5_correctedangle && ./measures.vs.k.R ../Zn_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Zn_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Zn_results/biaa6_correctedangle && ./measures.vs.k.R ../Zn_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Zn_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Mg_results/biaa5_correctedangle && ./measures.vs.k.R ../Mg_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Mg_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Mg_results/biaa6_correctedangle && ./measures.vs.k.R ../Mg_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Mg_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Ca_results/biaa5_correctedangle && ./measures.vs.k.R ../Ca_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Ca_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Ca_results/biaa6_correctedangle && ./measures.vs.k.R ../Ca_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Ca_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Fe_results/biaa5_correctedangle && ./measures.vs.k.R ../Fe_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Fe_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Fe_results/biaa6_correctedangle && ./measures.vs.k.R ../Fe_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Fe_results/biaa6_correctedangle

nice -10 ./functional_characterization.R ../Na_results/biaa5_correctedangle && ./measures.vs.k.R ../Na_results/biaa5_correctedangle 5 && ./cluster_metric_graphs.R ../Na_results/biaa5_correctedangle
nice -10 ./functional_characterization.R ../Na_results/biaa6_correctedangle && ./measures.vs.k.R ../Na_results/biaa6_correctedangle 6 && ./cluster_metric_graphs.R ../Na_results/biaa6_correctedangle

## 1.10, Use the corrected angles as rules to separate normal vs. compressed angles
./rf.correctedangle.R ../Zn_results/crtag5_correctedangle
./rf.correctedangle.R ../Mg_results/crtag5_correctedangle
./rf.correctedangle.R ../Ca_results/crtag5_correctedangle
./rf.correctedangle.R ../Fe_results/crtag5_correctedangle
./rf.correctedangle.R ../Na_results/crtag5_correctedangle

cp -r Zn_results/crtag5_correctedangle/ Zn_results/crtag6_correctedangle/
cp -r Mg_results/crtag5_correctedangle/ Mg_results/crtag6_correctedangle/
cp -r Ca_results/crtag5_correctedangle/ Ca_results/crtag6_correctedangle/
cp -r Fe_results/crtag5_correctedangle/ Fe_results/crtag6_correctedangle/
cp -r Na_results/crtag5_correctedangle/ Na_results/crtag6_correctedangle/

cp -r Zn_results/crtag5/ Zn_results/crtag6/
cp -r Mg_results/crtag5/ Mg_results/crtag6/
cp -r Ca_results/crtag5/ Ca_results/crtag6/
cp -r Fe_results/crtag5/ Fe_results/crtag6/
cp -r Na_results/crtag5/ Na_results/crtag6/

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag6_correctedangle 6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag5_correctedangle 5 && nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag6_correctedangle 6


## 1.11
nice -10 ./functional_characterization.R ../Zn_results/crtag5_correctedangle && ./measures.vs.k.R ../Zn_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Zn_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Zn_results/crtag6_correctedangle && ./measures.vs.k.R ../Zn_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Zn_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Mg_results/crtag5_correctedangle && ./measures.vs.k.R ../Mg_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Mg_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Mg_results/crtag6_correctedangle && ./measures.vs.k.R ../Mg_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Mg_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Ca_results/crtag5_correctedangle && ./measures.vs.k.R ../Ca_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Ca_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Ca_results/crtag6_correctedangle && ./measures.vs.k.R ../Ca_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Ca_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Fe_results/crtag5_correctedangle && ./measures.vs.k.R ../Fe_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Fe_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Fe_results/crtag6_correctedangle && ./measures.vs.k.R ../Fe_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Fe_results/crtag6_correctedangle
nice -10 ./functional_characterization.R ../Na_results/crtag5_correctedangle && ./measures.vs.k.R ../Na_results/crtag5_correctedangle 5 && ./cluster_metric_graphs.R ../Na_results/crtag5_correctedangle
nice -10 ./functional_characterization.R ../Na_results/crtag6_correctedangle && ./measures.vs.k.R ../Na_results/crtag6_correctedangle 6 && ./cluster_metric_graphs.R ../Na_results/crtag6_correctedangle

## comment out kmean and measures using corrected angles
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/crtag6 6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag5 5 && nice -10 ./kmeans.mnr.optimalk.R ../Na_results/crtag6 6

## rerun measure graph so the rho is more scalable
./cluster_metric_graphs.R ../Zn_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Zn_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Mg_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Mg_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Ca_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Ca_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Fe_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Fe_results/crtag6_correctedangle
./cluster_metric_graphs.R ../Na_results/crtag5_correctedangle
./cluster_metric_graphs.R ../Na_results/crtag6_correctedangle

./cluster_metric_graphs.R ../Zn_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Zn_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Mg_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Mg_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Ca_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Ca_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Fe_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Fe_results/biaa6_correctedangle
./cluster_metric_graphs.R ../Na_results/biaa5_correctedangle
./cluster_metric_graphs.R ../Na_results/biaa6_correctedangle

./cluster_metric_graphs.R ../output_Zn_biaa5
./cluster_metric_graphs.R ../output_Zn_biaa6
./cluster_metric_graphs.R ../output_Mg_biaa5
./cluster_metric_graphs.R ../output_Mg_biaa6
./cluster_metric_graphs.R ../output_Ca_biaa5
./cluster_metric_graphs.R ../output_Ca_biaa6
./cluster_metric_graphs.R ../output_Fe_biaa5
./cluster_metric_graphs.R ../output_Fe_biaa6
./cluster_metric_graphs.R ../output_Na_biaa5
./cluster_metric_graphs.R ../output_Na_biaa6

./cluster_metric_graphs.R ../output_Zn_single5
./cluster_metric_graphs.R ../output_Zn_single6
./cluster_metric_graphs.R ../output_Mg_single5
./cluster_metric_graphs.R ../output_Mg_single6
./cluster_metric_graphs.R ../output_Ca_single5
./cluster_metric_graphs.R ../output_Ca_single6
./cluster_metric_graphs.R ../output_Fe_single5
./cluster_metric_graphs.R ../output_Fe_single6
./cluster_metric_graphs.R ../output_Na_single5
./cluster_metric_graphs.R ../output_Na_single6

nice -10 ./functional_characterization.R ../Zn_results/crtag5 && ./measures.vs.k.R ../Zn_results/crtag5 5 && ./cluster_metric_graphs.R ../Zn_results/crtag5
nice -10 ./functional_characterization.R ../Zn_results/crtag6 && ./measures.vs.k.R ../Zn_results/crtag6 6 && ./cluster_metric_graphs.R ../Zn_results/crtag6
nice -10 ./functional_characterization.R ../Mg_results/crtag5 && ./measures.vs.k.R ../Mg_results/crtag5 5 && ./cluster_metric_graphs.R ../Mg_results/crtag5
nice -10 ./functional_characterization.R ../Mg_results/crtag6 && ./measures.vs.k.R ../Mg_results/crtag6 6 && ./cluster_metric_graphs.R ../Mg_results/crtag6
nice -10 ./functional_characterization.R ../Ca_results/crtag5 && ./measures.vs.k.R ../Ca_results/crtag5 5 && ./cluster_metric_graphs.R ../Ca_results/crtag5
nice -10 ./functional_characterization.R ../Ca_results/crtag6 && ./measures.vs.k.R ../Ca_results/crtag6 6 && ./cluster_metric_graphs.R ../Ca_results/crtag6
nice -10 ./functional_characterization.R ../Fe_results/crtag5 && ./measures.vs.k.R ../Fe_results/crtag5 5 && ./cluster_metric_graphs.R ../Fe_results/crtag5
nice -10 ./functional_characterization.R ../Fe_results/crtag6 && ./measures.vs.k.R ../Fe_results/crtag6 6 && ./cluster_metric_graphs.R ../Fe_results/crtag6
nice -10 ./functional_characterization.R ../Na_results/crtag5 && ./measures.vs.k.R ../Na_results/crtag5 5 && ./cluster_metric_graphs.R ../Na_results/crtag5
nice -10 ./functional_characterization.R ../Na_results/crtag6 && ./measures.vs.k.R ../Na_results/crtag6 6 && ./cluster_metric_graphs.R ../Na_results/crtag6


## Test on 4-ligand only zinc, Rf with and without corrected angle
./rf.crf.R ../Zn_results/4crf_6crtag 58 68
./rf.smallAngle.R ../Zn_results/4rf_6/ 58 68

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4crf_6crtag 6 1
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4rf_6/ 6 0

nice -10 ./functional_characterization.R ../Zn_results/4crf_6crtag && ./measures.vs.k.R ../Zn_results/4crf_6crtag 6 1 && ./cluster_metric_graphs.R ../Zn_results/4crf_6crtag
nice -10 ./functional_characterization.R ../Zn_results/4rf_6 && ./measures.vs.k.R ../Zn_results/4rf_6 6 0 && ./cluster_metric_graphs.R ../Zn_results/4rf_6
## Drop the corrected angles


## 1.19, Test to add #Lig as a dimension 
cp -r root_beforeRF/ rf_6p1
./rf.smallAngle.R ../Zn_results/rf_6p1 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/rf_6p1 6

## Use overall angle standard deviation to normalize
cp -r root_beforeRF/ rf_6plus1
./rf.smallAngle.R ../Zn_results/rf_6plus1 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/rf_6plus1 6

cp -r output_Zn_singleLig6 afterkmeans_6plus1
./measures.vs.k.R ../Zn_results/afterkmeans_6plus1 6 && ./cluster_metric_graphs.R ../Zn_results/afterkmeans_6plus1

nice -10 ./functional_characterization.R ../Zn_results/rf_6p1 6 && ./measures.vs.k.R ../Zn_results/rf_6p1 6 && ./cluster_metric_graphs.R ../Zn_results/rf_6p1
nice -10 ./functional_characterization.R ../Zn_results/rf_6plus1 6 && ./measures.vs.k.R ../Zn_results/rf_6plus1 6 && ./cluster_metric_graphs.R ../Zn_results/rf_6plus1

## Test on 5-ligand zinc, using all-angles space (7 angle space)
cp -r root_beforeRF 5ligand_7
./rf.smallAngle.R ../Zn_results/5ligand_7 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_7 7
nice -10 ./functional_characterization.R ../Zn_results/5ligand_7 && ./measures.vs.k.R ../Zn_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/5ligand_7

## Try the 6 angle space and see if that is what was causing lower rho
cp -r root_beforeRF 5ligand_6
./rf.smallAngle.R ../Zn_results/5ligand_6 58 68
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_6 6 && nice -10 ./functional_characterization.R ../Zn_results/5ligand_6 && ./measures.vs.k.R ../Zn_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/5ligand_6

## 10.21, Run all metals with different #lig separately
mv Mg_results/output_Mg_singleLig Mg_results/root_afterRF
mv Ca_results/output_Ca_singleLig Ca_results/root_afterRF
mv Fe_results/output_Fe_singleLig Fe_results/root_afterRF
mv Na_results/output_Na_singleLig Na_results/root_afterRF

cp -r Mg_results/root_afterRF Mg_results/4ligand_7
cp -r Ca_results/root_afterRF Ca_results/4ligand_7
cp -r Fe_results/root_afterRF Fe_results/4ligand_7
cp -r Na_results/root_afterRF Na_results/4ligand_7

cp -r Mg_results/root_afterRF Mg_results/5ligand_6
cp -r Mg_results/root_afterRF Mg_results/5ligand_7
cp -r Ca_results/root_afterRF Ca_results/5ligand_6
cp -r Ca_results/root_afterRF Ca_results/5ligand_7
cp -r Fe_results/root_afterRF Fe_results/5ligand_6
cp -r Fe_results/root_afterRF Fe_results/5ligand_7
cp -r Na_results/root_afterRF Na_results/5ligand_6
cp -r Na_results/root_afterRF Na_results/5ligand_7

cp -r Zn_results/root_afterRF Zn_results/6ligand_6
cp -r Zn_results/root_afterRF Zn_results/6ligand_7
cp -r Mg_results/root_afterRF Mg_results/6ligand_6
cp -r Mg_results/root_afterRF Mg_results/6ligand_7
cp -r Ca_results/root_afterRF Ca_results/6ligand_6
cp -r Ca_results/root_afterRF Ca_results/6ligand_7
cp -r Fe_results/root_afterRF Fe_results/6ligand_6
cp -r Fe_results/root_afterRF Fe_results/6ligand_7
cp -r Na_results/root_afterRF Na_results/6ligand_6
cp -r Na_results/root_afterRF Na_results/6ligand_7

cp -r Mg_results/root_afterRF Mg_results/7ligand_6
cp -r Mg_results/root_afterRF Mg_results/7ligand_7
cp -r Ca_results/root_afterRF Ca_results/7ligand_6
cp -r Fe_results/root_afterRF Fe_results/7ligand_7
cp -r Na_results/root_afterRF Na_results/7ligand_6
cp -r Na_results/root_afterRF Na_results/7ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/4ligand_7 4 7  
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/4ligand_7 4 7 && nice -10 ./functional_characterization.R ../Ca_results/4ligand_7 && ./measures.vs.k.R ../Ca_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/4ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/4ligand_7 4 7 
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/4ligand_7 4 7 
#Some functional analysis failed

nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_6 5 6 
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_6 && ./measures.vs.k.R ../Ca_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_6 && ./measures.vs.k.R ../Fe_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Na_results/5ligand_6 && ./measures.vs.k.R ../Na_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/5ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_7 5 7 
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_7 && ./measures.vs.k.R ../Ca_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_7 && ./measures.vs.k.R ../Fe_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Na_results/5ligand_7 && ./measures.vs.k.R ../Na_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/5ligand_7

## After Robert fixed the functional analysis. So maybe test if the new functional analysis works the same for before
nice -10 ./functional_characterization.R ../Mg_results/output_Mg_single6 & ./measures.vs.k.R ../Mg_results/output_Mg_single6 6 && ./cluster_metric_graphs.R ../Mg_results/output_Mg_single6

nice -10 ./functional_characterization.R ../Fe_results/4ligand_7 && ./measures.vs.k.R ../Fe_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/4ligand_7
## worked!

## still not work, out of boundary; run after another fix
nice -10 ./functional_characterization.R ../Mg_results/4ligand_7 && ./measures.vs.k.R ../Mg_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/4ligand_7
nice -10 ./functional_characterization.R ../Mg_results/5ligand_6 && ./measures.vs.k.R ../Mg_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/5ligand_6
nice -10 ./functional_characterization.R ../Mg_results/5ligand_7 && ./measures.vs.k.R ../Mg_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/5ligand_7
nice -10 ./functional_characterization.R ../Na_results/4ligand_7 && ./measures.vs.k.R ../Na_results/4ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/4ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_6 && ./measures.vs.k.R ../Zn_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_6 6 6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_6 && ./measures.vs.k.R ../Ca_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_6 && ./measures.vs.k.R ../Fe_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Na_results/6ligand_6 && ./measures.vs.k.R ../Na_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/6ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_7 && ./measures.vs.k.R ../Zn_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_7 6 7 
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_7 && ./measures.vs.k.R ../Ca_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_7 && ./measures.vs.k.R ../Fe_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Na_results/6ligand_7 && ./measures.vs.k.R ../Na_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/6ligand_7

## out of boundary ones, run after another fix
nice -10 ./functional_characterization.R ../Mg_results/6ligand_6 && ./measures.vs.k.R ../Mg_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/6ligand_6
nice -10 ./functional_characterization.R ../Mg_results/6ligand_7 && ./measures.vs.k.R ../Mg_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/6ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_6 7 6 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_6 && ./measures.vs.k.R ../Ca_results/7ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/7ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_7 7 7 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_7 && ./measures.vs.k.R ../Ca_results/7ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/7ligand_7

## finish 8-ligand for Ca
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_6 8 6 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_6 && ./measures.vs.k.R ../Ca_results/8ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/8ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_7 8 7 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_7 && ./measures.vs.k.R ../Ca_results/8ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/8ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/ligNNOO_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/ligNNOO_6
## need to change the #lig check in measure
nice -10 ./measures.vs.k.R ../Zn_results/ligNNOO_6 6 && ./cluster_metric_graphs.R ../Zn_results/ligNNOO_6


## index error on #lig
nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4ligand_7correct 4 7 && nice -10 ./functional_characterization.R ../Zn_results/4ligand_7correct && ./measures.vs.k.R ../Zn_results/4ligand_7correct 7 && ./cluster_metric_graphs.R ../Zn_results/4ligand_7correct


## move all number of ligand results to obs
mkdir Mg_results/obs
mv Mg_results/*ligand* Mg_results/obs/.
mkdir Ca_results/obs
mv Ca_results/*ligand* Ca_results/obs/.
mkdir Na_results/obs
mv Na_results/*ligand* Na_results/obs/.
mkdir Fe_results/obs
mv Fe_results/*ligand* Fe_results/obs/.
mkdir Zn_results/obs
Zn_results/*ligand* Zn_results/obs/.
mv Zn_results/ligNNOO_6 Zn_results/obs/.

#rerun everything
cp -r Zn_results/root_afterRF Zn_results/4ligand_6
cp -r Mg_results/root_afterRF Mg_results/4ligand_6
cp -r Ca_results/root_afterRF Ca_results/4ligand_6
cp -r Fe_results/root_afterRF Fe_results/4ligand_6
cp -r Na_results/root_afterRF Na_results/4ligand_6

cp -r Zn_results/root_afterRF Zn_results/5ligand_6
cp -r Zn_results/root_afterRF Zn_results/5ligand_7
cp -r Mg_results/root_afterRF Mg_results/5ligand_6
cp -r Mg_results/root_afterRF Mg_results/5ligand_7
cp -r Ca_results/root_afterRF Ca_results/5ligand_6
cp -r Ca_results/root_afterRF Ca_results/5ligand_7
cp -r Fe_results/root_afterRF Fe_results/5ligand_6
cp -r Fe_results/root_afterRF Fe_results/5ligand_7
cp -r Na_results/root_afterRF Na_results/5ligand_6
cp -r Na_results/root_afterRF Na_results/5ligand_7

cp -r Zn_results/root_afterRF Zn_results/6ligand_6
cp -r Zn_results/root_afterRF Zn_results/6ligand_7
cp -r Mg_results/root_afterRF Mg_results/6ligand_6
cp -r Mg_results/root_afterRF Mg_results/6ligand_7
cp -r Ca_results/root_afterRF Ca_results/6ligand_6
cp -r Ca_results/root_afterRF Ca_results/6ligand_7
cp -r Fe_results/root_afterRF Fe_results/6ligand_6
cp -r Fe_results/root_afterRF Fe_results/6ligand_7
cp -r Na_results/root_afterRF Na_results/6ligand_6
cp -r Na_results/root_afterRF Na_results/6ligand_7

cp -r Ca_results/root_afterRF Ca_results/7ligand_6
cp -r Ca_results/root_afterRF Ca_results/7ligand_7
cp -r Ca_results/root_afterRF Ca_results/8ligand_6
cp -r Ca_results/root_afterRF Ca_results/8ligand_7


nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Zn_results/4ligand_6 && ./measures.vs.k.R ../Zn_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Mg_results/4ligand_6 && ./measures.vs.k.R ../Mg_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Ca_results/4ligand_6 && ./measures.vs.k.R ../Ca_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Fe_results/4ligand_6 && ./measures.vs.k.R ../Fe_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/4ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/4ligand_6 4 6 && nice -10 ./functional_characterization.R ../Na_results/4ligand_6 && ./measures.vs.k.R ../Na_results/4ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/4ligand_6


nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Zn_results/5ligand_6 && ./measures.vs.k.R ../Zn_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Mg_results/5ligand_6 && ./measures.vs.k.R ../Mg_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_6 && ./measures.vs.k.R ../Ca_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_6 && ./measures.vs.k.R ../Fe_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/5ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_6 5 6 && nice -10 ./functional_characterization.R ../Na_results/5ligand_6 && ./measures.vs.k.R ../Na_results/5ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/5ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Zn_results/5ligand_7 && ./measures.vs.k.R ../Zn_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Mg_results/5ligand_7 && ./measures.vs.k.R ../Mg_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Ca_results/5ligand_7 && ./measures.vs.k.R ../Ca_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Fe_results/5ligand_7 && ./measures.vs.k.R ../Fe_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/5ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/5ligand_7 5 7 && nice -10 ./functional_characterization.R ../Na_results/5ligand_7 && ./measures.vs.k.R ../Na_results/5ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/5ligand_7


nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_6 && ./measures.vs.k.R ../Zn_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Zn_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Mg_results/6ligand_6 && ./measures.vs.k.R ../Mg_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Mg_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_6 && ./measures.vs.k.R ../Ca_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_6 && ./measures.vs.k.R ../Fe_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Fe_results/6ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_6 6 6 && nice -10 ./functional_characterization.R ../Na_results/6ligand_6 && ./measures.vs.k.R ../Na_results/6ligand_6 6 && ./cluster_metric_graphs.R ../Na_results/6ligand_6

nice -10 ./kmeans.mnr.optimalk.R ../Zn_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Zn_results/6ligand_7 && ./measures.vs.k.R ../Zn_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Zn_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Mg_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Mg_results/6ligand_7 && ./measures.vs.k.R ../Mg_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Mg_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Ca_results/6ligand_7 && ./measures.vs.k.R ../Ca_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Fe_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Fe_results/6ligand_7 && ./measures.vs.k.R ../Fe_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Fe_results/6ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Na_results/6ligand_7 6 7 && nice -10 ./functional_characterization.R ../Na_results/6ligand_7 && ./measures.vs.k.R ../Na_results/6ligand_7 7 && ./cluster_metric_graphs.R ../Na_results/6ligand_7

nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_6 7 6 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_6 && ./measures.vs.k.R ../Ca_results/7ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/7ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/7ligand_7 7 7 && nice -10 ./functional_characterization.R ../Ca_results/7ligand_7 && ./measures.vs.k.R ../Ca_results/7ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/7ligand_7
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_6 8 6 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_6 && ./measures.vs.k.R ../Ca_results/8ligand_6 6 && ./cluster_metric_graphs.R ../Ca_results/8ligand_6
nice -10 ./kmeans.mnr.optimalk.R ../Ca_results/8ligand_7 8 7 && nice -10 ./functional_characterization.R ../Ca_results/8ligand_7 && ./measures.vs.k.R ../Ca_results/8ligand_7 7 && ./cluster_metric_graphs.R ../Ca_results/8ligand_7

nice -10 ./kmeans.mnr.optimalk.3.R ../Zn_results/ligNNOO_6 6 6 && nice -10 ./functional_characterization.R ../Zn_results/ligNNOO_6 && nice -10 ./measures.vs.k.0.R ../Zn_results/ligNNOO_6 6 && ./cluster_metric_graphs.R ../Zn_results/ligNNOO_6


## 1.31, Test all metals together with the same #ligand
nice -10 ./kmeans.mnr.optimalk.2.R allMetal_results/4ligand_6 4 6
nice -10 ./kmeans.mnr.optimalk.2.R allMetal_results/5ligand_6 5 6
nice -10 ./kmeans.mnr.optimalk.2.R allMetal_results/6ligand_6 6 6

## 2.1, combine diff metal files
cat Zn_results/4ligand_6/non_redundant.ipr.tsv Ca_results/4ligand_6/non_redundant.ipr.tsv Na_results/4ligand_6/non_redundant.ipr.tsv Mg_results/4ligand_6/non_redundant.ipr.tsv Fe_results/4ligand_6/non_redundant.ipr.tsv >allMetal_results/4ligand_6/non_redundant.ipr.tsv
cat Zn_results/4ligand_6/r.allLig.txt Ca_results/4ligand_6/r.allLig.txt Na_results/4ligand_6/r.allLig.txt Mg_results/4ligand_6/r.allLig.txt Fe_results/4ligand_6/r.allLig.txt >allMetal_results/4ligand_6/r.allLig.txt

nice -10 ./functional_characterization.R ../allMetal_results/4ligand_6
nice -10 ./functional_characterization.R ../allMetal_results/5ligand_6
nice -10 ./functional_characterization.R ../allMetal_results/6ligand_6

nice -10 ./measures.vs.k.1.R ../allMetal_results/4ligand_6 6 && ./cluster_metric_graphs.R ../allMetal_results/4ligand_6
nice -10 ./measures.vs.k.1.R ../allMetal_results/5ligand_6 6 && ./cluster_metric_graphs.R ../allMetal_results/5ligand_6
nice -10 ./measures.vs.k.1.R ../allMetal_results/6ligand_6 6 && ./cluster_metric_graphs.R ../allMetal_results/6ligand_6

## 2.5 simulation
mkdir 1_1
mkdir 1_2
... 

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 1
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 2
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 3
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 4
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 5
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 6
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 7
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 8
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 9
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 10
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 11
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 12
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 13
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 14
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 15
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 16
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 17
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 18
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 19
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 1 20


nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 1 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 1
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 2 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 2
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 3 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 3
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 4 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 4
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 5 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 5
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 6 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 6
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 7 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 7
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 8 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 8
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 9 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 9
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 10 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 10
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 11 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 11
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 12 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 12
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 13 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 13
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 14 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 14
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 15 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 15
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 16 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 16
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 17 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 17
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 18 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 18
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 19 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 19
nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 1 20 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 1 20


## make up for what didn't run correctly before

./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 1
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 2
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 3
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 4
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 5
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 6
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 7
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 8
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 9
./measures.vs.k.2.R ../Zn_results/4ligand_6 6 6 10


nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 13 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 13 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 13
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 14 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 14 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 14

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 15 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 15 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 15
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 16 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 16 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 16

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 17 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 17 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 17
nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 18 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 18 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 18

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 19 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 19 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 19

nice -10 ./kmeans.mnr.optimalk.5.R ../Zn_results/4ligand_6 4 6 18 20 && nice -10 ./functional_characterization.1.R ../Zn_results/4ligand_6 18 20 && nice -10 ./measures.vs.k.2.R ../Zn_results/4ligand_6 6 18 20


### 2.15, run non-redundant on all metals together
cat Zn_results/root_afterRF/seqs.SEQRES.shell.txt Mg_results/root_afterRF/seqs.SEQRES.shell.txt Ca_results/root_afterRF/seqs.SEQRES.shell.txt Fe_results/root_afterRF/seqs.SEQRES.shell.txt Na_results/root_afterRF/seqs.SEQRES.shell.txt > allMetal_results/beforeNR/seqs.SEQRES.shell.txt
cat Zn_results/root_afterRF/seqs.SEQRES.bind.txt Mg_results/root_afterRF/seqs.SEQRES.bind.txt Ca_results/root_afterRF/seqs.SEQRES.bind.txt Fe_results/root_afterRF/seqs.SEQRES.bind.txt Na_results/root_afterRF/seqs.SEQRES.bind.txt > allMetal_results/beforeNR/seqs.SEQRES.bind.txt
cat Zn_results/root_afterRF/seqs.ATOM.shell.txt Mg_results/root_afterRF/seqs.ATOM.shell.txt Ca_results/root_afterRF/seqs.ATOM.shell.txt Fe_results/root_afterRF/seqs.ATOM.shell.txt Na_results/root_afterRF/seqs.ATOM.shell.txt > allMetal_results/beforeNR/seqs.ATOM.shell.txt
cat Zn_results/root_afterRF/r.allLig.txt Mg_results/root_afterRF/r.allLig.txt Ca_results/root_afterRF/r.allLig.txt Fe_results/root_afterRF/r.allLig.txt Na_results/root_afterRF/r.allLig.txt > allMetal_results/beforeNR/r.allLig.txt
cat Zn_results/root_afterRF/rf.smallest.txt Mg_results/root_afterRF/rf.smallest.txt Ca_results/root_afterRF/rf.smallest.txt Fe_results/root_afterRF/rf.smallest.txt Na_results/root_afterRF/rf.smallest.txt > allMetal_results/beforeNR/rf.smallest.txt

./seq_alignment.R ../allMetal_results/beforeNR/

## check rmsd of all metal, all number of ligand
./cluster.centers.prob.R ../Na_results/5ligand_6/ 7 10 14 11| less


## Test IA process
./metalCoordinations.pl test.ca.1.txt Ca 3.094 O -i p 0.001 test

## 3.4, respond to the attackiing paper, too close ligands and metal occupancy
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd ../Zn_results/root_fcshell/stats -r ../Zn_results/root_fcshell/r.allLig.occupancy.txt  > ../Zn_results/root_fcshell/out.tooclose.txt

## 3.21, added symmetry related calculation, occupancy, and solvent metal. Test on Zn
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.zn.stats -r test.zn.r.txt 

## 3.24, 
./metalCoordinations.pl test.zn.1000.txt Zn 2.783 SON -dd test.zn.stats -r test.zn.r.txt
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.zn.all.stats -r test.zn.all.r.txt

## 3.25, run on nyx and print out symmetry number with overall overlapping range check; multi processing with PDB parser
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -bs > test.overallSymNum.txt

## 3.27, check metal atoms with symmetry related range, and how many smmetry related sets need to be calculated; single processing with PDB parser
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -bs > test.metSym.txt
R -q -e "x <- read.csv('test.metSym.txt', header = F); summary(x); mean(x[ , 2], na.rm=TRUE)" ## 12.63832
R -q -e "x <- read.csv('test.overallSymNum.txt', header = F); summary(x); mean(x[ , 2], na.rm=TRUE)" ## 36.55767

## 3.28, fix the neighboring XYZ error
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.stats -r test.zn.r.3.28.txt > test.metSym.txt


## 3.30, fix the xyz range error
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.stats -r test.zn.r.3.30.txt > test.metSym.3.30.txt

## 4.4, choose the best alterate locations, and remove sites with non-biological symmetry-related ligands
./metalCoordinations.pl test.ca.2.txt Ca 3.094 O -dd test
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.783 SON -dd test.stats -r test.zn.r.4.4.txt > test.metSym.4.4.txt

## 4.6, check if multi-processing at CG level vs. ordered combo level gives the same results
./metalCoordinations.pl ../new_coordination/pathfile.2.txt Zn 2.783 ONS -i p 0.001 test.combo > test.paraCombo.txt
./metalCoordinations.pl ../new_coordination/pathfile.2.txt Zn 2.783 ONS -i p 0.001 test.CG >test.paraCG.txt

## 4.7, there are different ones between CG and combo, 1KOG, try rerun
./metalCoordinations.pl test.zn.1.txt Zn 2.783 ONS -i p 0.001 test.CG > test.CG.txt
./metalCoordinations.pl test.zn.1.txt Zn 2.783 ONS -i p 0.001 test.combo > test.combo.txt


## Start running everything from the beginning
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_zn/stats -r ../output_zn/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_mg/stats -r ../output_mg/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_ca/stats -r ../output_ca/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_fe/stats -r ../output_fe/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_na/stats -r ../output_na/bondlength.withC.txt &

## The above should use -bondLength option
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -r ../output_zn/r.allLig.txt -rf ../output_zn/rf.smallest.txt -s a s ../output_zn/seqs.ATOM.shell.txt -s s s ../output_zn/seqs.SEQRES.shell.txt -s s b ../output_zn/seqs.SEQRES.bind.txt -bondLength ../output_zn/bondlength.noC.txt; date

date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -s a s ../output_mg/seqs.ATOM.shell.txt -s s s ../output_mg/seqs.SEQRES.shell.txt -s s b ../output_mg/seqs.SEQRES.bind.txt -rf ../output_mg/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -r ../output_ca/r.allLig.txt -s a s ../output_ca/seqs.ATOM.shell.txt -s s s ../output_ca/seqs.SEQRES.shell.txt -s s b ../output_ca/seqs.SEQRES.bind.txt -rf ../output_ca/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.638 SON -dd ../output_fe/stats.r -r ../output_fe/r.allLig.txt -s a s ../output_fe/seqs.ATOM.shell.txt -s s s ../output_fe/seqs.SEQRES.shell.txt -s s b ../output_fe/seqs.SEQRES.bind.txt -rf ../output_fe/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt -rf ../output_na/rf.smallest.txt; date

## 4.14, fixed an error in selecting ligands at the -dd step, it could affect both -rf and -sb
mv ../output_ca/seqs.SEQRES.bind.txt ../output_ca/seqs.SEQRES.bind.old.txt ## to compare with the new one
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -rf ../output_zn/rf.smallest.txt -s s b ../output_zn/seqs.SEQRES.bind.txt ; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -rf ../output_ca/rf.smallest.txt -s s b ../output_ca/seqs.SEQRES.bind.txt ; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.638 SON -dd ../output_fe/stats.r -s s b ../output_fe/seqs.SEQRES.bind.txt -rf ../output_fe/rf.smallest.txt; date
## Problem fixed!

## rerun all options
date; ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -r ../output_zn/r.allLig.txt -rf ../output_zn/rf.smallest.txt -s a s ../output_zn/seqs.ATOM.shell.txt -s s s ../output_zn/seqs.SEQRES.shell.txt -s s b ../output_zn/seqs.SEQRES.bind.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt -rf ../output_na/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -s a s ../output_mg/seqs.ATOM.shell.txt -s s s ../output_mg/seqs.SEQRES.shell.txt -s s b ../output_mg/seqs.SEQRES.bind.txt -rf ../output_mg/rf.smallest.txt; date

## Zn: 5h. Na: 9.5h.
## 4.16, rerun Ca and Fe
date; ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -r ../output_ca/r.allLig.txt -s a s ../output_ca/seqs.ATOM.shell.txt -s s s ../output_ca/seqs.SEQRES.shell.txt -s s b ../output_ca/seqs.SEQRES.bind.txt -rf ../output_ca/rf.smallest.txt; date
date; ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -dd ../output_fe/stats.r -r ../output_fe/r.allLig.txt -s a s ../output_fe/seqs.ATOM.shell.txt -s s s ../output_fe/seqs.SEQRES.shell.txt -s s b ../output_fe/seqs.SEQRES.bind.txt -rf ../output_fe/rf.smallest.txt; date

## Ca: 5h. Fe: 5h. Mg: 27h
## Rerun bondlength option
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../output_zn/stats -bondLength ../output_zn/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../output_ca/stats -bondLength ../output_ca/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../output_fe/stats -bondLength ../output_fe/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../output_na/stats -bondLength ../output_na/bondlength.withC.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../output_mg/stats -bondLength ../output_mg/bondlength.withC.txt &

## proceed with sequence alignment
./seq_alignment.R ../output_zn/
./seq_alignment.R ../output_mg/ && ./seq_alignment.R ../output_ca/ && ./seq_alignment.R ../output_fe/ && ./seq_alignment.R ../output_na/

./nonRedundancy.R ../output_zn/ 
./nonRedundancy.R ../output_mg/ && ./nonRedundancy.R ../output_ca/ && ./nonRedundancy.R ../output_fe/ && ./nonRedundancy.R ../output_na/

## 4.19
./write_fasta.R ../output_zn/
./write_fasta.R ../output_mg/ && ./write_fasta.R ../output_ca/ && ./write_fasta.R ../output_fe/ && ./write_fasta.R ../output_na/

## copy everything into root_beforeRF folder
mkdir output_mg/root_beforeRF
cp output_mg/* output_mg/root_beforeRF/

./rf.smallAngle.R ../output_zn 58 68
./rf.smallAngle.R ../output_mg 52 68
./rf.smallAngle.R ../output_ca 55 65
./rf.smallAngle.R ../output_fe 63 73
./rf.smallAngle.R ../output_na 45 60

./kmeans.mnr.optimalk.R ../output_zn/allLigand/ 6
./kmeans.mnr.optimalk.4.R ../output_zn/4ligand/ 4 6
#./kmeans.mnr.optimalk.4.R ../output_zn/5ligand/ 5 6
#./kmeans.mnr.optimalk.4.R ../output_zn/6ligand/ 6 6

## To make r and rf files match, rerun to remove all duplicated metal ids
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -r ../output_zn/r.allLig.txt -rf ../output_zn/rf.smallest.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -rf ../output_mg/rf.smallest.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -r ../output_ca/r.allLig.txt -rf ../output_ca/rf.smallest.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -dd ../output_fe/stats.r -r ../output_fe/r.allLig.txt -rf ../output_fe/rf.smallest.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -rf ../output_na/rf.smallest.txt &

## 4.20 remove metal sites with symmetry ligands
./nonRedundancy.R ../output_zn/
./nonRedundancy.R ../output_ca/ 
./nonRedundancy.R ../output_fe/ 
./nonRedundancy.R ../output_na/

./write_fasta.R ../output_zn/ && ./write_fasta.R ../output_ca/ && ./write_fasta.R ../output_fe/ && ./write_fasta.R ../output_na/
./rf.smallAngle.R ../output_zn 58 68
./rf.smallAngle.R ../output_ca 55 65
./rf.smallAngle.R ../output_fe 63 73
./rf.smallAngle.R ../output_na 45 60

## change the metal accordingly, :1079,1092s/ca/zn/g
mkdir output_zn/root_afterRF
cp output_zn/* output_zn/root_afterRF/
cp -r output_zn/root_afterRF output_zn/allLig
cp -r output_zn/root_afterRF output_zn/4ligand
cp -r output_zn/root_afterRF output_zn/5ligand
cp -r output_zn/root_afterRF output_zn/6ligand
cp -r output_zn/root_afterRF output_zn/7ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_zn/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/7ligand 7 6


ssh interproscan
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_mg
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

## 4.21 
./nonRedundancy.R ../output_mg/ 
./write_fasta.R ../output_mg/
./rf.smallAngle.R ../output_mg 52 68

## Running interproscan on local machines is much faster than on the interproscan VM
## Proceed with functional analysis
## copy non_redundant.ipr.tsv into all sub-directories
for d in */; do cp non_redundant.ipr.tsv "$d"; done

nice -10 ./functional_characterization.R ../output_fe/allLig && nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./functional_characterization.R ../output_fe/4ligand && nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./functional_characterization.R ../output_fe/5ligand && nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./functional_characterization.R ../output_fe/6ligand && nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./functional_characterization.R ../output_fe/noheme && nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

## A typo in measures*
nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand
nice -10 ./measures.vs.k.R ../output_na/8ligand 6 && ./cluster_metric_graphs.R ../output_na/8ligand


nice -10 ./measures.vs.k.R ../output_na/noheme 6 && ./cluster_metric_graphs.R ../output_na/noheme

## 4.22 start IA for all metals
./metalCoordinations.pl test.ca.2.txt Ca 3.092 O -i -r test.txt

nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -i p 0.001 ../output_zn/stats.i -r ../output_zn/r.chi.txt -r ../output_zn/r.chi.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -i p 0.001 ../output_mg/stats.i -r ../output_mg/r.chi.txt -r ../output_mg/r.chi.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -i p 0.001 ../output_ca/stats.i -r ../output_ca/r.chi.txt -r ../output_ca/r.chi.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -i p 0.001 ../output_fe/stats.i -r ../output_fe/r.chi.txt -r ../output_fe/r.chi.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -i p 0.001 ../output_na/stats.i -r ../output_na/r.chi.txt  -r ../output_na/r.chi.leaveOut.txt leaveOut

## 4.25, run only bootstrap with no C and updated cutoff, and get bondlength output for bl-std vs. resolution analysis
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -bs ../output_zn/stats.bs -bondLength ../output_zn/bondlength.noC.txt & 
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -bs ../output_mg/stats.bs -bondLength ../output_mg/bondlength.noC.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -bs ../output_ca/stats.bs -bondLength ../output_ca/bondlength.noC.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -bs ../output_fe/stats.bs -bondLength ../output_fe/bondlength.noC.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -bs ../output_na/stats.bs -bondLength ../output_na/bondlength.noC.txt &

## 4.26
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.r -r ../output_zn/r.allLig.txt -rf ../output_zn/rf.smallest.txt -s a s ../output_zn/seqs.ATOM.shell.txt -s s s ../output_zn/seqs.SEQRES.shell.txt -s s b ../output_zn/seqs.SEQRES.bind.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -rf ../output_mg/rf.smallest.txt -s a s ../output_mg/seqs.ATOM.shell.txt -s s s ../output_mg/seqs.SEQRES.shell.txt -s s b ../output_mg/seqs.SEQRES.bind.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.r -r ../output_ca/r.allLig.txt -rf ../output_ca/rf.smallest.txt -s a s ../output_ca/seqs.ATOM.shell.txt -s s s ../output_ca/seqs.SEQRES.shell.txt -s s b ../output_ca/seqs.SEQRES.bind.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -dd ../output_fe/stats.r -r ../output_fe/r.allLig.txt -rf ../output_fe/rf.smallest.txt -s a s ../output_fe/seqs.ATOM.shell.txt -s s s ../output_fe/seqs.SEQRES.shell.txt -s s b ../output_fe/seqs.SEQRES.bind.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -rf ../output_na/rf.smallest.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt &

## exclude sites with more than 64 metal ions
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -dd ../output_mg/stats.r -r r.allLig.txt -rf rf.smallest.txt -s a s seqs.ATOM.shell.txt -s s s seqs.SEQRES.shell.txt -s s b seqs.SEQRES.bind.txt &

## 4.27, use short mg for now
./seq_alignment.R ../output_zn/
./seq_alignment.R ../output_smg/ 
./seq_alignment.R ../output_ca/ 
./seq_alignment.R ../output_fe/ 

./nonRedundancy.R ../output_zn/
./nonRedundancy.R ../output_smg/
./nonRedundancy.R ../output_ca/
./nonRedundancy.R ../output_fe/

./write_fasta.R ../output_zn/ && ./write_fasta.R ../output_smg/ && ./write_fasta.R ../output_ca/ && ./write_fasta.R ../output_fe/

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_zn
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_smg
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_ca
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_fe
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

./rf.smallAngle.R ../output_zn 58 68
./rf.smallAngle.R ../output_smg 52 68
./rf.smallAngle.R ../output_ca 55 65
./rf.smallAngle.R ../output_fe 63 73

cp atom2seq.RData finalMetalList.RData non_redundant.fa nonredundant.list.txt non_redundant.RData rf.results.RData rf.smallest.txt seqs.ATOM.shell.txt seqs.SEQRES.bind.txt  seqs.SEQRES.shell.txt r.allLig.txt stats.r.0.txt non_redundant.ipr.tsv bondlength.noC.txt stats.bs.0.txt root_afterRF/
rm -r allLig 4ligand 5ligand 6ligand
cp -r root_afterRF allLig
cp -r root_afterRF 4ligand
cp -r root_afterRF 5ligand
cp -r root_afterRF 6ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_zn/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/6ligand 6 6

nice -10 ./kmeans.mnr.optimalk.R ../output_smg/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_smg/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_smg/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_smg/6ligand 6 6                                                                                                                                                    

nice -10 ./kmeans.mnr.optimalk.R ../output_fe/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/noheme noheme 6

## for some reason, non_redundant.ipr.tsv is borken in output_ca
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/7ligand 7 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/8ligand 8 6

## Need to run Na without N
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -bs ../output_na/stats.bs -bondLength ../output_na/bondlength.noC.txt &
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -rf ../output_na/rf.smallest.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt -bondLength ../output_na/bondlength.r.txt &

## 4.28 finish zn, smg, ca, and fe
nice -10 ./functional_characterization.R ../output_zn/allLig && nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./functional_characterization.R ../output_zn/4ligand && nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./functional_characterization.R ../output_zn/5ligand && nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./functional_characterization.R ../output_zn/6ligand && nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

nice -10 ./functional_characterization.R ../output_smg/allLig && nice -10 ./measures.vs.k.R ../output_smg/allLig 6 && ./cluster_metric_graphs.R ../output_smg/allLig
nice -10 ./functional_characterization.R ../output_smg/4ligand && nice -10 ./measures.vs.k.R ../output_smg/4ligand 6 && ./cluster_metric_graphs.R ../output_smg/4ligand
nice -10 ./functional_characterization.R ../output_smg/5ligand && nice -10 ./measures.vs.k.R ../output_smg/5ligand 6 && ./cluster_metric_graphs.R ../output_smg/5ligand
nice -10 ./functional_characterization.R ../output_smg/6ligand && nice -10 ./measures.vs.k.R ../output_smg/6ligand 6 && ./cluster_metric_graphs.R ../output_smg/6ligand

nice -10 ./functional_characterization.R ../output_ca/allLig && nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./functional_characterization.R ../output_ca/4ligand && nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./functional_characterization.R ../output_ca/5ligand && nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./functional_characterization.R ../output_ca/6ligand && nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./functional_characterization.R ../output_ca/7ligand && nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./functional_characterization.R ../output_ca/8ligand && nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

nice -10 ./functional_characterization.R ../output_fe/allLig && nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./functional_characterization.R ../output_fe/4ligand && nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./functional_characterization.R ../output_fe/5ligand && nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./functional_characterization.R ../output_fe/6ligand && nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./functional_characterization.R ../output_fe/noheme && nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

## catch up with Mg full
./seq_alignment.R ../output_mg/
./nonRedundancy.R ../output_mg/
./write_fasta.R ../output_mg/
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_mg
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
./rf.smallAngle.R ../output_mg 52 68

cp atom2seq.RData finalMetalList.RData non_redundant.fa nonredundant.list.txt non_redundant.RData rf.results.RData rf.smallest.txt seqs.ATOM.shell.txt seqs.SEQRES.bind.txt  seqs.SEQRES.shell.txt r.allLig.txt stats.r.0.txt non_redundant.ipr.tsv bondlength.noC.txt stats.bs.0.txt root_afterRF/
rm -r allLig 4ligand 5ligand 6ligand
cp -r root_afterRF allLig
cp -r root_afterRF 4ligand
cp -r root_afterRF 5ligand
cp -r root_afterRF 6ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_mg/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/6ligand 6 6

nice -10 ./functional_characterization.R ../output_mg/allLig && nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./functional_characterization.R ../output_mg/4ligand && nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./functional_characterization.R ../output_mg/5ligand && nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./functional_characterization.R ../output_mg/6ligand && nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

## Run -dd again to get -bondLength output for plotting the bond length distribution, each on a diff machine
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -dd ../output_zn/stats.rr -bondLength ../output_zn/bondlength.r.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -dd ../output_mg/stats.rr -bondLength ../output_mg/bondlength.r.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -dd ../output_ca/stats.rr -bondLength ../output_ca/bondlength.r.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -dd ../output_fe/stats.rr -bondLength ../output_fe/bondlength.r.txt &


## Continue with Na
## Cannot open file for sequence, run again on a diff machine
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -dd ../output_na/stats.rr -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt & ## S0
./seq_alignment.R ../output_na/
./nonRedundancy.R ../output_na/
./write_fasta.R ../output_na/
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_na
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
./rf.smallAngle.R ../output_na 45 60

cp atom2seq.RData finalMetalList.RData non_redundant.fa nonredundant.list.txt non_redundant.RData rf.results.RData rf.smallest.txt seqs.ATOM.shell.txt seqs.SEQRES.bind.txt  seqs.SEQRES.shell.txt r.allLig.txt stats.r.0.txt non_redundant.ipr.tsv bondlength.noC.txt stats.bs.0.txt root_afterRF/
rm -r allLig 4ligand 5ligand 6ligand
cp -r root_afterRF allLig
cp -r root_afterRF 4ligand
cp -r root_afterRF 5ligand
cp -r root_afterRF 6ligand
cp -r root_afterRF 7ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_na/allLig all 6 #S7
nice -10 ./kmeans.mnr.optimalk.R ../output_na/4ligand 4 6 #S8
nice -10 ./kmeans.mnr.optimalk.R ../output_na/5ligand 5 6 #S8
nice -10 ./kmeans.mnr.optimalk.R ../output_na/6ligand 6 6 #S9
nice -10 ./kmeans.mnr.optimalk.R ../output_na/7ligand 7 6 #S9

nice -10 ./functional_characterization.R ../output_na/allLig && nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./functional_characterization.R ../output_na/4ligand && nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./functional_characterization.R ../output_na/5ligand && nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./functional_characterization.R ../output_na/6ligand && nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./functional_characterization.R ../output_na/7ligand && nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand

## Get bondlength.r.txt for Mg-short
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -dd ../output_smg/stats.rr -bondLength ../output_smg/bondlength.r.txt & ## S8

## Start combined, but has to wait 
cat output_zn/r.allLig.txt output_mg/r.allLig.txt output_ca/r.allLig.txt output_fe/r.allLig.txt output_na/r.allLig.txt > output_all/r.allLig.txt
cat output_zn/rf.smallest.txt output_mg/rf.smallest.txt output_ca/rf.smallest.txt output_fe/rf.smallest.txt output_na/rf.smallest.txt > output_all/rf.smallest.txt

## 4.29
cat output_zn/seqs.SEQRES.shell.txt output_mg/seqs.SEQRES.shell.txt output_ca/seqs.SEQRES.shell.txt output_fe/seqs.SEQRES.shell.txt output_na/seqs.SEQRES.shell.txt > output_all/seqs.SEQRES.shell.txt
cat output_zn/seqs.SEQRES.bind.txt output_mg/seqs.SEQRES.bind.txt output_ca/seqs.SEQRES.bind.txt output_fe/seqs.SEQRES.bind.txt output_na/seqs.SEQRES.bind.txt > output_all/seqs.SEQRES.bind.txt
cat output_zn/seqs.ATOM.shell.txt output_mg/seqs.ATOM.shell.txt output_ca/seqs.ATOM.shell.txt output_fe/seqs.ATOM.shell.txt output_na/seqs.ATOM.shell.txt > output_all/seqs.ATOM.shell.txt

./seq_alignment.R ../output_all/
./nonRedundancy.R ../output_all/
./write_fasta.R ../output_all/
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_all
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

cp ../output_all/* ../output_all/root_afterRF/
cp -r ../output_all/root_afterRF ../output_all/allLig
cp -r ../output_all/root_afterRF ../output_all/4ligand
cp -r ../output_all/root_afterRF ../output_all/5ligand
cp -r ../output_all/root_afterRF ../output_all/6ligand
cp -r ../output_all/root_afterRF ../output_all/7ligand

./combine.predictions.R

nice -10 ./kmeans.mnr.optimalk.R ../output_all/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/7ligand 7 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/allLig all 6

nice -10 ./functional_characterization.R ../output_all/4ligand
nice -10 ./functional_characterization.R ../output_all/5ligand
nice -10 ./functional_characterization.R ../output_all/6ligand
nice -10 ./functional_characterization.R ../output_all/7ligand
nice -10 ./functional_characterization.R ../output_all/allLig

nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/7ligand 6 && ./cluster_metric_graphs.R ../output_all/7ligand
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig


## Try -i again with no comp angles. cp the old results into a folder
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -i c 68 ../output_zn/stats.i -r ../output_zn/r.chi.c68.txt -r ../output_zn/r.chi.c68.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -i c 65 ../output_smg/stats.i -r ../output_smg/r.chi.c65.txt -r ../output_smg/r.chi.c65.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -i c 60 ../output_ca/stats.i -r ../output_ca/r.chi.c60.txt -r ../output_ca/r.chi.c60.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -i c 68 ../output_fe/stats.i -r ../output_fe/r.chi.c68.txt -r ../output_fe/r.chi.c68.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -i c 60 ../output_na/stats.i -r ../output_na/r.chi.c60.txt  -r ../output_na/r.chi.c60.leaveOut.txt leaveOut

## 5.3, print probabilities for all CGs, not just the highest one.
./metalCoordinations.pl test.zn.1.txt Zn 2.782 SON -bs stats -probs test.prob.txt 0 ../output_zn/ia.c68/stats.i.12.txt
./metalCoordinations.pl test.zn.1.txt Zn 2.782 SON test.json.txt -bs stats -probs test.prob.txt 0 ../output_zn/ia.c68/stats.i.12.txt

nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON ../output_zn/shells.json.txt -bs ../output_zn/stats.p -probs ../output_zn/chiprobs.txt 0 ../output_zn/ia.c68/stats.i.12.txt
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON ../output_mg/shells.json.txt -bs ../output_mg/stats.p 
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON ../output_smg/shells.json.txt -bs ../output_smg/stats.p -probs ../output_smg/chiprobs.txt 0 ../output_smg/ia.c65/stats.i.15.txt
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O ../output_ca/shells.json.txt -bs ../output_ca/stats.p -probs ../output_ca/chiprobs.txt 0 ../output_ca/ia.c60/stats.i.15.txt
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON ../output_fe/sells.json.txt -bs ../output_fe/stats.p -probs ../output_fe/chiprobs.txt 0 ../output_fe/ia.c68/stats.i.15.txt
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O ../output_na/shells.json.txt -bs ../output_na/stats.p -probs ../output_na/chiprobs.txt 0 ../output_na/ia.c60/stats.i.15.txt

## 5.5, 
./metalCoordinations.pl test.ca.2.txt Ca 3.092 O test.json.txt -bs stats -probs test.prob.txt 0 ../output_ca/ia.c60/stats.i.20.txt

./metalCoordinations.pl test.ca.2.txt Ca 3.092 O -i stats 
./metalCoordinations.pl test.ca.2.txt Ca 3.092 O -bs stats -probs test.prob.txt 0 stats.4.txt

## 5.8, rho-size simulation
mkdir simulation ## under output_zn/simulation
mkdir 20_1
mkdir 20_2
mkdir 20_3
mkdir 20_4
mkdir 20_5
mkdir 20_6
mkdir 20_7
mkdir 20_8
mkdir 20_9
mkdir 20_10
mkdir 20_11
mkdir 20_12
mkdir 20_13
mkdir 20_14
mkdir 20_15
mkdir 20_16
mkdir 20_17
mkdir 20_18
mkdir 20_19
mkdir 20_20

./run.simulation.bh 2
./run.simulation.bh 3
./run.simulation.bh 4
./run.simulation.bh 5
 
## remove too-close sites
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn -bs ../new_zn/stats -bondLength ../new_zn/bondlength.withC.txt > ../new_zn/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca -bs ../new_ca/stats -bondLength ../new_ca/bondlength.withC.txt > ../new_ca/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe -bs ../new_fe/stats -bondLength ../new_fe/bondlength.withC.txt > ../new_fe/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na -bs ../new_na/stats -bondLength ../new_na/bondlength.withC.txt > ../new_na/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg -bs ../new_mg/stats -bondLength ../new_mg/bondlength.withC.txt > ../new_mg/out.tooclose.txt &

## The above actually doesn't get affected by too-close filter
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON ../new_zn/json.txt -dd ../new_zn/stats.r -r ../new_zn/r.allLig.txt -rf ../new_zn/rf.smallest.txt -s a s ../new_zn/seqs.ATOM.shell.txt -s s s ../new_zn/seqs.SEQRES.shell.txt -s s b ../new_zn/seqs.SEQRES.bind.txt -bondLength ../new_zn/bondlength.r.txt > ../new_zn/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O ../new_ca/json.txt -dd ../new_ca/stats.r -r ../new_ca/r.allLig.txt -rf ../new_ca/rf.smallest.txt -s a s ../new_ca/seqs.ATOM.shell.txt -s s s ../new_ca/seqs.SEQRES.shell.txt -s s b ../new_ca/seqs.SEQRES.bind.txt -bondLength ../new_ca/bondlength.r.txt > ../new_ca/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON ../new_fe/json.txt -dd ../new_fe/stats.r -r ../new_fe/r.allLig.txt -rf ../new_fe/rf.smallest.txt -s a s ../new_fe/seqs.ATOM.shell.txt -s s s ../new_fe/seqs.SEQRES.shell.txt -s s b ../new_fe/seqs.SEQRES.bind.txt -bondLength ../new_fe/bondlength.r.txt > ../new_fe/out.tooclose.txt &
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 ON ../new_na/json.txt -dd ../new_na/stats.r -r ../new_na/r.allLig.txt -rf ../new_na/rf.smallest.txt -s a s ../new_na/seqs.ATOM.shell.txt -s s s ../new_na/seqs.SEQRES.shell.txt -s s b ../new_na/seqs.SEQRES.bind.txt -bondLength ../new_na/bondlength.r.txt > ../new_na/out.tooclose.txt &

./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON ../new_mg/json.txt -dd ../new_mg/stats.r -r ../new_mg/r.allLig.txt -rf ../new_mg/rf.smallest.txt -s a s ../new_mg/seqs.ATOM.shell.txt -s s s ../new_mg/seqs.SEQRES.shell.txt -s s b ../new_mg/seqs.SEQRES.bind.txt -bondLength ../new_mg/bondlength.r.txt > ../new_mg/out.tooclose.txt 

## 5.9
./seq_alignment.R ../new_zn/
./seq_alignment.R ../new_ca/
./seq_alignment.R ../new_fe/
./seq_alignment.R ../new_na/

## non redundant test
./nonRedundancy.R ../new_zn/
./nonRedundancy.R ../new_ca/
./nonRedundancy.R ../new_fe/
./nonRedundancy.R ../new_na/

./write_fasta.R ../new_zn/ && ./write_fasta.R ../new_ca/ && ./write_fasta.R ../new_fe/ && ./write_fasta.R ../new_na/

output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/new_zn
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/new_ca
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/new_fe
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/new_na
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

./rf.smallAngle.R ../new_zn 58 68
./rf.smallAngle.R ../new_ca 55 65
./rf.smallAngle.R ../new_fe 63 73
./rf.smallAngle.R ../new_na 45 60


## after using the normal chi for Sqa and  Tpr
#nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -i c 68 ../output_zn/stats.i -r ../output_zn/r.chi.c68.txt -r ../output_zn/r.chi.c68.leaveOut.txt leaveOut
#nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -i c 65 ../output_smg/stats.i -r ../output_smg/r.chi.c65.txt -r ../output_smg/r.chi.c65.leaveOut.txt leaveOut
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -i c 60 ../output_ca/ia.modefiedChi/stats.i -r ../output_ca/ia.modefiedChi/r.chi.c60.txt -r ../output_ca/ia.modefiedChi/r.chi.c60.leaveOut.txt leaveOut > ../output_ca/ia.modefiedChi/out.txt 
#nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -i c 68 ../output_fe/stats.i -r ../output_fe/r.chi.c68.txt -r ../output_fe/r.chi.c68.leaveOut.txt leaveOut
#nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -i c 60 ../output_na/stats.i -r ../output_na/r.chi.c60.txt  -r ../output_na/r.chi.c60.leaveOut.txt leaveOut

## 5.10, run most with run.fullanalysis.bh, but changed the stru-func correlation to handle ties
nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand


## 5.11, hypnos got rebooted, had to rerun 
nice -10 ./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON ../output_mg/json.txt -dd ../output_mg/stats.r -r ../output_mg/r.allLig.txt -rf ../output_mg/rf.smallest.txt -s a s ../output_mg/seqs.ATOM.shell.txt -s s s ../output_mg/seqs.SEQRES.shell.txt -s s b ../output_mg/seqs.SEQRES.bind.txt -bondLength ../output_mg/bondlength.r.txt > ../output_mg/out.tooclose.txt


## 5.12, finish with Mg
./seq_alignment.R ../output_mg/
./nonRedundancy.R ../output_mg/
./write_fasta.R ../output_mg/ 
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_mg
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
./rf.smallAngle.R ../output_mg 52 68

mkdir ../output_mg/root_afterRF/
cp ../output_mg/* ../output_mg/root_afterRF/.
cp -r ../output_mg/root_afterRF ../output_mg/allLig
cp -r ../output_mg/root_afterRF ../output_mg/4ligand
cp -r ../output_mg/root_afterRF ../output_mg/5ligand
cp -r ../output_mg/root_afterRF ../output_mg/6ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_mg/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/6ligand 6 6

nice -10 ./functional_characterization.R ../output_mg/allLig && nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./functional_characterization.R ../output_mg/4ligand && nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./functional_characterization.R ../output_mg/5ligand && nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./functional_characterization.R ../output_mg/6ligand && nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

## Use 1.5 variance on no correlation chi prob calculation
mkdir ../output_ca/ia.c60/
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -i c 60 ../output_ca/ia.c60/stats.i -r ../output_ca/ia.c60/r.chi.txt -r ../output_ca/ia.c60/r.chi.leaveOut.txt leaveOut -probs ../output_ca/ia.c60/probs.txt 0 -probs ../output_ca/ia.c60/probs.leaveOut.txt leaveOut > ../output_ca/ia.c60/out.txt 

## 5.18
#mkdir ../output_zn/ia.c68/
#./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -i c 68 ../output_zn/ia.c68/stats.i -r ../output_zn/ia.c68/r.chi.txt -r ../output_zn/ia.c68/r.chi.leaveOut.txt leaveOut -probs ../output_zn/ia.c68/probs.txt 0 -probs ../output_zn/ia.c68/probs.leaveOut.txt leaveOut > ../output_zn/ia.c68/out.txt
## did not work

## 5.19
mkdir ../output_fe/ia.c68/
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -i c 68 ../output_fe/ia.c68/stats.i -r ../output_fe/ia.c68/r.chi.txt -r ../output_fe/ia.c68/r.chi.leaveOut.txt leaveOut -probs ../output_fe/ia.c68/probs.txt 0 -probs ../output_fe/ia.c68/probs.leaveOut.txt leaveOut > ../output_fe/ia.c68/out.txt

# 5.21
mkdir ../output_na/ia.c60/
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -i c 60 ../output_na/ia.c60/stats.i -r ../output_na/ia.c60/r.chi.txt -r ../output_na/ia.c60/r.chi.leaveOut.txt leaveOut -probs ../output_na/ia.c60/probs.txt 0 -probs ../output_na/ia.c60/probs.leaveOut.txt leaveOut > ../output_na/ia.c60/out.txt

mkdir ../output_mg/ia.c65/
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -i c 65 ../output_mg/ia.c65/stats.i -r ../output_mg/ia.c65/r.chi.txt -r ../output_mg/ia.c65/r.chi.leaveOut.txt leaveOut -probs ../output_mg/ia.c65/probs.txt 0 -probs ../output_mg/ia.c65/probs.leaveOut.txt leaveOut > ../output_mg/ia.c65/out.txt

./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -i c 68 ../output_zn/ia.c68/stats.i -r ../output_zn/ia.c68/r.chi.txt -r ../output_zn/ia.c68/r.chi.leaveOut.txt leaveOut -probs ../output_zn/ia.c68/probs.txt 0 -probs ../output_zn/ia.c68/probs.leaveOut.txt leaveOut > ../output_zn/ia.c68/out.txt


## 5.25, the simulation was incorrect b/c kmeans.5 ordered the rawdata by id,

## The simulation average probability code was in the simulation folder
./simulation.rhop.R 1 normal 9
./simulation.rhop.R 1.25 normal 9
./simulation.rhop.R 1.5 normal 9
./simulation.rhop.R 1.75 normal 9
./simulation.rhop.R 2 normal 9
...

./simulation.rhop.R 1 normal 11
./simulation.rhop.R 1 normal 13

## 5.26, Mg keep getting killed, try high memory machine, nyx
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 SON -i c 65 ../output_mg/ia.c65/stats.i -r ../output_mg/ia.c65/r.chi.txt -r ../output_mg/ia.c65/r.chi.leaveOut.txt leaveOut -probs ../output_mg/ia.c65/probs.txt 0 -probs ../output_mg/ia.c65/probs.leaveOut.txt leaveOut > ../output_mg/ia.c65/out.txt

./run.simulation.bh 20

./run.simulation.bh 17
./run.simulation.bh 18

./run.simulation.bh 19
./run.simulation.bh 1.75


## 5.31
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 11 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 11 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 11
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 12 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 12 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 12
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 13 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 13 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 13
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 14 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 14 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 14
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 15 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 15 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 15

nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 16 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 16 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 16
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 17 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 17 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 17
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 18 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 18 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 18
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 19 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 19 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 19
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 20 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 20 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 20

nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 6 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 6 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 6
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 7 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 7 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 7
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 8 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 8 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 8
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 9 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 9 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 9
nice -10 ./kmeans.mnr.optimalk.5.R ../output_zn/4ligand 4 6 20 10 && nice -10 ./functional_characterization.1.R ../output_zn/4ligand 20 10 && nice -10 ./measures.vs.k.2.R ../output_zn/4ligand 6 20 10

## 6.1, Na had N after adding too-close filter, rurun
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O ../output_na/json.txt -dd ../output_na/stats.r -r ../output_na/r.allLig.txt -rf ../output_na/rf.smallest.txt -s a s ../output_na/seqs.ATOM.shell.txt -s s s ../output_na/seqs.SEQRES.shell.txt -s s b ../output_na/seqs.SEQRES.bind.txt -bondLength ../output_na/bondlength.r.txt > ../output_na/out.tooclose.txt 
./seq_alignment.R ../output_na/
./nonRedundancy.R ../output_na/
./write_fasta.R ../output_na/
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_na
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
./rf.smallAngle.R ../output_na 45 60

mkdir ../output_na/root_afterRF/
cp ../output_na/* ../output_na/root_afterRF/.
cp -r ../output_na/root_afterRF ../output_na/allLig
cp -r ../output_na/root_afterRF ../output_na/4ligand
cp -r ../output_na/root_afterRF ../output_na/5ligand
cp -r ../output_na/root_afterRF ../output_na/6ligand
cp -r ../output_na/root_afterRF ../output_na/7ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_na/allLig all 6 && nice -10 ./functional_characterization.R ../output_na/allLig && nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./kmeans.mnr.optimalk.R ../output_na/4ligand 4 6 && nice -10 ./functional_characterization.R ../output_na/4ligand && nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./kmeans.mnr.optimalk.R ../output_na/5ligand 5 6 && nice -10 ./functional_characterization.R ../output_na/5ligand && nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./kmeans.mnr.optimalk.R ../output_na/6ligand 6 6 && nice -10 ./functional_characterization.R ../output_na/6ligand && nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./kmeans.mnr.optimalk.R ../output_na/7ligand 7 6 && nice -10 ./functional_characterization.R ../output_na/7ligand && nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand

## Combined
cat output_zn/r.allLig.txt output_mg/r.allLig.txt output_ca/r.allLig.txt output_fe/r.allLig.txt output_na/r.allLig.txt > output_all/r.allLig.txt
cat output_zn/rf.smallest.txt output_mg/rf.smallest.txt output_ca/rf.smallest.txt output_fe/rf.smallest.txt output_na/rf.smallest.txt > output_all/rf.smallest.txt
cat output_zn/seqs.SEQRES.shell.txt output_mg/seqs.SEQRES.shell.txt output_ca/seqs.SEQRES.shell.txt output_fe/seqs.SEQRES.shell.txt output_na/seqs.SEQRES.shell.txt > output_all/seqs.SEQRES.shell.txt
cat output_zn/seqs.SEQRES.bind.txt output_mg/seqs.SEQRES.bind.txt output_ca/seqs.SEQRES.bind.txt output_fe/seqs.SEQRES.bind.txt output_na/seqs.SEQRES.bind.txt > output_all/seqs.SEQRES.bind.txt
cat output_zn/seqs.ATOM.shell.txt output_mg/seqs.ATOM.shell.txt output_ca/seqs.ATOM.shell.txt output_fe/seqs.ATOM.shell.txt output_na/seqs.ATOM.shell.txt > output_all/seqs.ATOM.shell.txt

nice -10 ./seq_alignment.R ../output_all/
nice -10 ./nonRedundancy.R ../output_all/
nice -10 ./write_fasta.R ../output_all/
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_all
nice -10 /mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv

### Combined RF prediction results
./combine.predictions.R

mkdir ../output_all/root_afterRF/
cp ../output_all/* ../output_all/root_afterRF/
cp -r ../output_all/root_afterRF ../output_all/allLig
cp -r ../output_all/root_afterRF ../output_all/4ligand
cp -r ../output_all/root_afterRF ../output_all/5ligand
cp -r ../output_all/root_afterRF ../output_all/6ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_all/4ligand 4 6
nice -10 ./functional_characterization.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_all/5ligand 5 6
nice -10 ./functional_characterization.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_all/6ligand 6 6
nice -10 ./functional_characterization.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand

nice -10 ./kmeans.mnr.optimalk.R ../output_all/allLig all 6
nice -10 ./functional_characterization.R ../output_all/allLig
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig

#####################
./center.prob.metallist.R ../output_zn/4ligand/ 9 13 12 7
./center.prob.metallist.R ../output_zn/5ligand/ 10 8 7 7
./center.prob.metallist.R ../output_zn/6ligand/ 6 10 8 7
./center.prob.metallist.R ../output_zn/allLig/ 7 10 7 6

./center.prob.metallist.R ../output_mg/4ligand/ 8 8 7 7
./center.prob.metallist.R ../output_mg/5ligand/ 7 11 7 7
./center.prob.metallist.R ../output_mg/6ligand/ 6 13 8 7
./center.prob.metallist.R ../output_mg/allLig/ 7 7 7 6

./center.prob.metallist.R ../output_ca/4ligand/ 14 10 13 7
./center.prob.metallist.R ../output_ca/5ligand/ 8 18 6 7
./center.prob.metallist.R ../output_ca/6ligand/ 9 16 7 7
./center.prob.metallist.R ../output_ca/7ligand/ 7 18 14 7
./center.prob.metallist.R ../output_ca/8ligand/ 8 8 10 7
./center.prob.metallist.R ../output_ca/allLig/ 8 8 8 6

./center.prob.metallist.R ../output_fe/4ligand/ 6 1 7 7
./center.prob.metallist.R ../output_fe/5ligand/ 7 7 7 7
./center.prob.metallist.R ../output_fe/6ligand/ 7 7 10 7
./center.prob.metallist.R ../output_fe/allLig/ 5 8 8 6
./center.prob.metallist.R ../output_fe/noheme/ 9 8 7 6

./center.prob.metallist.R ../output_na/4ligand/ 6 10 6 7
./center.prob.metallist.R ../output_na/5ligand/ 8 18 7 7
./center.prob.metallist.R ../output_na/6ligand/ 7 29 7 7
./center.prob.metallist.R ../output_na/7ligand/ 6 10 7 7
./center.prob.metallist.R ../output_na/allLig/ 9 6 7 6

./center.prob.metallist.R ../output_all/4ligand/ 9 13 7 7
./center.prob.metallist.R ../output_all/5ligand/ 7 7 7 7
./center.prob.metallist.R ../output_all/6ligand/ 10 7 8 7
#####################


## 6.2, Na was exit wiredly, so test it again and put all results in a 'test' folder
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O ../output_na/test/json.txt -dd ../output_na/test/stats.r -r ../output_na/test/r.allLig.txt -rf ../output_na/test/rf.smallest.txt -s a s ../output_na/test/seqs.ATOM.shell.txt -s s s ../output_na/test/seqs.SEQRES.shell.txt -s s b ../output_na/test/seqs.SEQRES.bind.txt -bondLength ../output_na/test/bondlength.r.txt > ../output_na/test/out.tooclose.txt
./seq_alignment.R ../output_na/test/
./nonRedundancy.R ../output_na/test/
./write_fasta.R ../output_na/test/
output_dir=/mlab/data/sen/projects/metal/go_ec_analysis/output_na
/mlab/data/software/interproscan-5.18-57.0/interproscan.sh -i $output_dir/non_redundant.fa -f tsv -iprlookup -pa -goterms -o $output_dir/non_redundant.ipr.tsv
./rf.smallAngle.R ../output_na/test/ 45 60
## Basically the same


## 6.4, Try only exclude 0's in the functional distances. And see which category cannot handle it. Use four_measures.RData temp. Change all figures name to be four_metric*.
nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand

nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig


## modify kmeans second compressed angle to be 59 so that 7-ligand Na compressed will have enough to be clustered 
nice -10 ./kmeans.mnr.optimalk.R ../output_na/7ligand 7 6
nice -10 ./functional_characterization.R ../output_na/7ligand && nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand



## 6.10
./hierarchical.clustering.R ../output_zn/4ligand 9 4 13 2
./hierarchical.clustering.R ../output_zn/5ligand 10 3 8 3
./hierarchical.clustering.R ../output_zn/6ligand 6 3 0 0
./hierarchical.clustering.R ../output_zn/allLig 7 4 10 1

./hierarchical.clustering.R ../output_mg/4ligand 8 2 8 1
./hierarchical.clustering.R ../output_mg/5ligand 7 3 11 3
./hierarchical.clustering.R ../output_mg/6ligand 6 3 13 1
./hierarchical.clustering.R ../output_mg/allLig 7 3 7 2

./hierarchical.clustering.R ../output_ca/4ligand 14 4 0 0 
./hierarchical.clustering.R ../output_ca/5ligand 8 4 18 4
./hierarchical.clustering.R ../output_ca/6ligand 9 2 16 1
./hierarchical.clustering.R ../output_ca/7ligand 7 1 18 3
./hierarchical.clustering.R ../output_ca/8ligand 8 2 8 2
./hierarchical.clustering.R ../output_ca/allLig 8 2 8 4

./hierarchical.clustering.R ../output_fe/4ligand 6 4 0 0
./hierarchical.clustering.R ../output_fe/5ligand 7 1 7 4
./hierarchical.clustering.R ../output_fe/6ligand 7 1 7 3
./hierarchical.clustering.R ../output_fe/allLig 5 1 8 3
./hierarchical.clustering.R ../output_fe/noheme 9 3 8 3

./hierarchical.clustering.R ../output_na/4ligand 6 4 0 0
./hierarchical.clustering.R ../output_na/5ligand 8 2 18 3
./hierarchical.clustering.R ../output_na/6ligand 7 4 29 1
./hierarchical.clustering.R ../output_na/7ligand 6 1 0 0
./hierarchical.clustering.R ../output_na/allLig 9 3 6 1

./hierarchical.clustering.R ../output_all/4ligand 9 3 13 4
./hierarchical.clustering.R ../output_all/5ligand 7 1 7 1 
./hierarchical.clustering.R ../output_all/6ligand 10 1 7 1 

## 6.11, make up for some incorrect ones
./getrhop.R zn 6 compressed 15 4
./center.prob.metallist.R ../output_zn/6ligand/ 6 15 8 7
./hierarchical.clustering.R ../output_zn/6ligand 6 3 15 4

## count clusters and stuff
./metalCoordinations.pl ../metalPDB/protein_list_Zn.txt Zn 2.782 SON -bs 
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -bs
./metalCoordinations.pl ../metalPDB/protein_list_Ca.txt Ca 3.092 O -bs 
./metalCoordinations.pl ../metalPDB/protein_list_Fe.txt Fe 2.639 SON -bs 
./metalCoordinations.pl ../metalPDB/protein_list_Na.txt Na 3.317 O -bs 


## 6.16, updated function package, and replace 0 with NA properly, change to four_measures_over_k.na.RData, and see with clusters changed
nice -10 ./functional_characterization.R ../output_zn/allLig && nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./functional_characterization.R ../output_zn/4ligand && nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./functional_characterization.R ../output_zn/5ligand && nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./functional_characterization.R ../output_zn/6ligand && nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

nice -10 ./functional_characterization.R ../output_mg/allLig && nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./functional_characterization.R ../output_mg/4ligand && nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./functional_characterization.R ../output_mg/5ligand && nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./functional_characterization.R ../output_mg/6ligand && nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

nice -10 ./functional_characterization.R ../output_ca/allLig && nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./functional_characterization.R ../output_ca/4ligand && nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./functional_characterization.R ../output_ca/5ligand && nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./functional_characterization.R ../output_ca/6ligand && nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./functional_characterization.R ../output_ca/7ligand && nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./functional_characterization.R ../output_ca/8ligand && nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

nice -10 ./functional_characterization.R ../output_fe/allLig && nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./functional_characterization.R ../output_fe/4ligand && nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./functional_characterization.R ../output_fe/5ligand && nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./functional_characterization.R ../output_fe/6ligand && nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./functional_characterization.R ../output_fe/noheme && nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

nice -10 ./functional_characterization.R ../output_na/allLig && nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./functional_characterization.R ../output_na/4ligand && nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./functional_characterization.R ../output_na/5ligand && nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./functional_characterization.R ../output_na/6ligand && nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./functional_characterization.R ../output_na/7ligand && nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand


nice -10 ./functional_characterization.R ../output_all/4ligand
nice -10 ./functional_characterization.R ../output_all/5ligand
nice -10 ./functional_characterization.R ../output_all/6ligand
nice -10 ./functional_characterization.R ../output_all/allLig

nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig


## Add occupancy filter, rerun everything, again...
## screen 0, hypnos
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_zn/6ligand 6 6

nice -10 ./functional_characterization.R ../output_zn/allLig && nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./functional_characterization.R ../output_zn/4ligand && nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./functional_characterization.R ../output_zn/5ligand && nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./functional_characterization.R ../output_zn/6ligand && nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

## screen 6, nyx
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_mg/6ligand 6 6

nice -10 ./functional_characterization.R ../output_mg/allLig && nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./functional_characterization.R ../output_mg/4ligand && nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./functional_characterization.R ../output_mg/5ligand && nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./functional_characterization.R ../output_mg/6ligand && nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

## screen 7, eros
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/7ligand 7 6
nice -10 ./kmeans.mnr.optimalk.R ../output_ca/8ligand 8 6

nice -10 ./functional_characterization.R ../output_ca/allLig && nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./functional_characterization.R ../output_ca/4ligand && nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./functional_characterization.R ../output_ca/5ligand && nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./functional_characterization.R ../output_ca/6ligand && nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./functional_characterization.R ../output_ca/7ligand && nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./functional_characterization.R ../output_ca/8ligand && nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

## screen 8, ananke
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_fe/noheme noheme 6

nice -10 ./functional_characterization.R ../output_fe/allLig && nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./functional_characterization.R ../output_fe/4ligand && nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./functional_characterization.R ../output_fe/5ligand && nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./functional_characterization.R ../output_fe/6ligand && nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./functional_characterization.R ../output_fe/noheme && nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

## screen 9, theseus. 7-ligand required to move second comp to 59 to have enough to cluster. Reversed back.
nice -10 ./kmeans.mnr.optimalk.R ../output_na/allLig all 6
nice -10 ./kmeans.mnr.optimalk.R ../output_na/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_na/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_na/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_na/7ligand 7 6

nice -10 ./functional_characterization.R ../output_na/allLig && nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./functional_characterization.R ../output_na/4ligand && nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./functional_characterization.R ../output_na/5ligand && nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./functional_characterization.R ../output_na/6ligand && nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./functional_characterization.R ../output_na/7ligand && nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand

## screen 10, morpheus, memory error: move to screen 6, nyx
nice -10 ./kmeans.mnr.optimalk.R ../output_all/4ligand 4 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/5ligand 5 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/6ligand 6 6
nice -10 ./kmeans.mnr.optimalk.R ../output_all/allLig all 6

nice -10 ./functional_characterization.R ../output_all/4ligand
nice -10 ./functional_characterization.R ../output_all/5ligand
nice -10 ./functional_characterization.R ../output_all/6ligand
nice -10 ./functional_characterization.R ../output_all/allLig

nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig

## While Eugene is on vacation, try Mg IA again with only ON
./metalCoordinations.pl ../metalPDB/protein_list_Mg.txt Mg 2.892 ON -i c 65 ../output_mg/ia.cutoff/stats.i -r ../output_mg/ia.cutoff/r.chi.txt -r ../output_mg/ia.cutoff/r.chi.leaveOut.txt leaveOut -probs ../output_mg/ia.cutoff/probs.txt 0 -probs ../output_mg/ia.cutoff/probs.leaveOut.txt leaveOut > ../output_mg/ia.cutoff/out.txt 

## The rho wha actually after removing all 0 still. Now just remove NAs.

nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand

nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig



./getrhop.R Zn 4 normal  9 4
./getrhop.R Zn 4 compressed  12 3
./getrhop.R Zn 4 combined  7 2
./getrhop.R Zn 5 normal  10 3
./getrhop.R Zn 5 compressed  7 1
./getrhop.R Zn 5 combined  7 3
./getrhop.R Zn 6 normal  6 1
./getrhop.R Zn 6 compressed  17 4
./getrhop.R Zn 6 combined  8 3
./getrhop.R Zn combined normal  7 4
./getrhop.R Zn combined compressed  12 3
./getrhop.R Zn combined combined  8 12
./getrhop.R Mg 4 normal  8 2
./getrhop.R Mg 4 compressed  8 1
./getrhop.R Mg 4 combined  7 3
./getrhop.R Mg 5 normal  7 2
./getrhop.R Mg 5 compressed  8 3
./getrhop.R Mg 5 combined  7 3
./getrhop.R Mg 6 normal  7 1
./getrhop.R Mg 6 compressed  13 1
./getrhop.R Mg 6 combined  8 1
./getrhop.R Mg combined normal  7 3
./getrhop.R Mg combined compressed  6 1
./getrhop.R Mg combined combined  8 3
./getrhop.R Ca 4 normal  13 4
./getrhop.R Ca 4 compressed   
./getrhop.R Ca 4 combined  18 4
./getrhop.R Ca 5 normal  8 1
./getrhop.R Ca 5 compressed  16 3
./getrhop.R Ca 5 combined  6 3
./getrhop.R Ca 6 normal  9 2
./getrhop.R Ca 6 compressed  16 1
./getrhop.R Ca 6 combined  6 2
./getrhop.R Ca 7 normal  7 4
./getrhop.R Ca 7 compressed  7 4
./getrhop.R Ca 7 combined  16 3
./getrhop.R Ca 8 normal  9 2
./getrhop.R Ca 8 compressed  8 2
./getrhop.R Ca 8 combined  9 1
./getrhop.R Ca combined normal  11 3
./getrhop.R Ca combined compressed  12 4
./getrhop.R Ca combined combined  9 4
./getrhop.R Fe 4 normal  5 4
./getrhop.R Fe 4 compressed  7 3
./getrhop.R Fe 4 combined  9 3
./getrhop.R Fe 5 normal  8 1
./getrhop.R Fe 5 compressed  7 4
./getrhop.R Fe 5 combined  7 1
./getrhop.R Fe 6 normal  7 1
./getrhop.R Fe 6 compressed  9 2
./getrhop.R Fe 6 combined  7 1
./getrhop.R Fe combined normal  10 1
./getrhop.R Fe combined compressed  8 3
./getrhop.R Fe combined combined  8 3
./getrhop.R Fe noheme normal  8 4
./getrhop.R Fe noheme compressed  7 3
./getrhop.R Fe noheme combined  8 3
./getrhop.R Na 4 normal  6 1
./getrhop.R Na 4 compressed   
./getrhop.R Na 4 combined  6 4
./getrhop.R Na 5 normal  11 3
./getrhop.R Na 5 compressed   
./getrhop.R Na 5 combined  5 1
./getrhop.R Na 6 normal  9 4
./getrhop.R Na 6 compressed  28 1
./getrhop.R Na 6 combined  9 3
./getrhop.R Na 7 normal  6 1
./getrhop.R Na 7 compressed   
./getrhop.R Na 7 combined  7 2
./getrhop.R Na combined normal  14 4
./getrhop.R Na combined compressed  5 1
./getrhop.R Na combined combined  10 4
./getrhop.R all 4 normal  11 3
./getrhop.R all 4 compressed  13 4
./getrhop.R all 4 combined  8 4
./getrhop.R all 5 normal  7 1
./getrhop.R all 5 compressed  7 1
./getrhop.R all 5 combined  6 3
./getrhop.R all 6 normal  10 1
./getrhop.R all 6 compressed  7 1
./getrhop.R all 6 combined  10 1


#### 6.20
./center.prob.metallist.R ../output_zn/4ligand/ 9 12 7 7
./center.prob.metallist.R ../output_zn/5ligand/ 10 7 7 7
./center.prob.metallist.R ../output_zn/6ligand/ 6 17 8 7
./center.prob.metallist.R ../output_zn/allLig/ 7 12 8 6

./center.prob.metallist.R ../output_mg/4ligand/ 8 8 7 7
./center.prob.metallist.R ../output_mg/5ligand/ 7 8 7 7
./center.prob.metallist.R ../output_mg/6ligand/ 7 13 8 7
./center.prob.metallist.R ../output_mg/allLig/ 7 6 8 6

./center.prob.metallist.R ../output_ca/4ligand/ 13 3 18 7
./center.prob.metallist.R ../output_ca/5ligand/ 8 16 6 7
./center.prob.metallist.R ../output_ca/6ligand/ 9 16 6 7
./center.prob.metallist.R ../output_ca/7ligand/ 7 7 16 7
./center.prob.metallist.R ../output_ca/8ligand/ 9 8 9 7
./center.prob.metallist.R ../output_ca/allLig/ 11 12 9 6

./center.prob.metallist.R ../output_fe/4ligand/ 5 7 9 7
./center.prob.metallist.R ../output_fe/5ligand/ 8 7 7 7
./center.prob.metallist.R ../output_fe/6ligand/ 7 9 7 7
./center.prob.metallist.R ../output_fe/allLig/ 10 8 8 6
./center.prob.metallist.R ../output_fe/noheme/ 8 7 8 6

./center.prob.metallist.R ../output_na/4ligand/ 6 3 6 7
./center.prob.metallist.R ../output_na/5ligand/ 11 3 5 7
./center.prob.metallist.R ../output_na/6ligand/ 9 28 9 7
./center.prob.metallist.R ../output_na/7ligand/ 6 3 7 7
./center.prob.metallist.R ../output_na/allLig/ 14 5 10 6

./center.prob.metallist.R ../output_all/4ligand/ 11 13 8 7
./center.prob.metallist.R ../output_all/5ligand/ 7 7 6 7
./center.prob.metallist.R ../output_all/6ligand/ 10 7 10 7
sures_normal.png
###
./hierarchical.clustering.R ../output_zn/4ligand 9 4 12 3
./hierarchical.clustering.R ../output_zn/5ligand 10 3 7 1
./hierarchical.clustering.R ../output_zn/6ligand 6 1 17 4
./hierarchical.clustering.R ../output_zn/allLig 7 4 12 3

./hierarchical.clustering.R ../output_mg/4ligand 8 2 8 1
./hierarchical.clustering.R ../output_mg/5ligand 7 2 8 3
./hierarchical.clustering.R ../output_mg/6ligand 7 1 13 1
./hierarchical.clustering.R ../output_mg/allLig 7 3 6 1

./hierarchical.clustering.R ../output_ca/4ligand 13 4 0 0
./hierarchical.clustering.R ../output_ca/5ligand 8 1 16 3
./hierarchical.clustering.R ../output_ca/6ligand 9 2 16 1
./hierarchical.clustering.R ../output_ca/7ligand 7 4 7 4
./hierarchical.clustering.R ../output_ca/8ligand 9 2 8 2
./hierarchical.clustering.R ../output_ca/allLig 11 3 12 4

./hierarchical.clustering.R ../output_fe/4ligand 5 4 7 3
./hierarchical.clustering.R ../output_fe/5ligand 8 1 7 4
./hierarchical.clustering.R ../output_fe/6ligand 7 1 9 2
./hierarchical.clustering.R ../output_fe/allLig 10 1 8 3
./hierarchical.clustering.R ../output_fe/noheme 8 4 7 3

./hierarchical.clustering.R ../output_na/4ligand 6 1 0 0
./hierarchical.clustering.R ../output_na/5ligand 11 3 0 0
./hierarchical.clustering.R ../output_na/6ligand 9 4 28 1
./hierarchical.clustering.R ../output_na/7ligand 6 1 0 0
./hierarchical.clustering.R ../output_na/allLig 14 4 5 1

./hierarchical.clustering.R ../output_all/4ligand 11 3 13 4
./hierarchical.clustering.R ../output_all/5ligand 7 1 7 1
./hierarchical.clustering.R ../output_all/6ligand 10 1 7 1


## re-plot all four_measures graphs, with .png names
nice -10 ./measures.vs.k.R ../output_zn/allLig 6 && ./cluster_metric_graphs.R ../output_zn/allLig
nice -10 ./measures.vs.k.R ../output_zn/4ligand 6 && ./cluster_metric_graphs.R ../output_zn/4ligand
nice -10 ./measures.vs.k.R ../output_zn/5ligand 6 && ./cluster_metric_graphs.R ../output_zn/5ligand
nice -10 ./measures.vs.k.R ../output_zn/6ligand 6 && ./cluster_metric_graphs.R ../output_zn/6ligand

nice -10 ./measures.vs.k.R ../output_mg/allLig 6 && ./cluster_metric_graphs.R ../output_mg/allLig
nice -10 ./measures.vs.k.R ../output_mg/4ligand 6 && ./cluster_metric_graphs.R ../output_mg/4ligand
nice -10 ./measures.vs.k.R ../output_mg/5ligand 6 && ./cluster_metric_graphs.R ../output_mg/5ligand
nice -10 ./measures.vs.k.R ../output_mg/6ligand 6 && ./cluster_metric_graphs.R ../output_mg/6ligand

nice -10 ./measures.vs.k.R ../output_ca/allLig 6 && ./cluster_metric_graphs.R ../output_ca/allLig
nice -10 ./measures.vs.k.R ../output_ca/4ligand 6 && ./cluster_metric_graphs.R ../output_ca/4ligand
nice -10 ./measures.vs.k.R ../output_ca/5ligand 6 && ./cluster_metric_graphs.R ../output_ca/5ligand
nice -10 ./measures.vs.k.R ../output_ca/6ligand 6 && ./cluster_metric_graphs.R ../output_ca/6ligand
nice -10 ./measures.vs.k.R ../output_ca/7ligand 6 && ./cluster_metric_graphs.R ../output_ca/7ligand
nice -10 ./measures.vs.k.R ../output_ca/8ligand 6 && ./cluster_metric_graphs.R ../output_ca/8ligand

nice -10 ./measures.vs.k.R ../output_fe/allLig 6 && ./cluster_metric_graphs.R ../output_fe/allLig
nice -10 ./measures.vs.k.R ../output_fe/4ligand 6 && ./cluster_metric_graphs.R ../output_fe/4ligand
nice -10 ./measures.vs.k.R ../output_fe/5ligand 6 && ./cluster_metric_graphs.R ../output_fe/5ligand
nice -10 ./measures.vs.k.R ../output_fe/6ligand 6 && ./cluster_metric_graphs.R ../output_fe/6ligand
nice -10 ./measures.vs.k.R ../output_fe/noheme 6 && ./cluster_metric_graphs.R ../output_fe/noheme

nice -10 ./measures.vs.k.R ../output_na/allLig 6 && ./cluster_metric_graphs.R ../output_na/allLig
nice -10 ./measures.vs.k.R ../output_na/4ligand 6 && ./cluster_metric_graphs.R ../output_na/4ligand
nice -10 ./measures.vs.k.R ../output_na/5ligand 6 && ./cluster_metric_graphs.R ../output_na/5ligand
nice -10 ./measures.vs.k.R ../output_na/6ligand 6 && ./cluster_metric_graphs.R ../output_na/6ligand
nice -10 ./measures.vs.k.R ../output_na/7ligand 6 && ./cluster_metric_graphs.R ../output_na/7ligand

nice -10 ./measures.vs.k.R ../output_all/4ligand 6 && ./cluster_metric_graphs.R ../output_all/4ligand
nice -10 ./measures.vs.k.R ../output_all/5ligand 6 && ./cluster_metric_graphs.R ../output_all/5ligand
nice -10 ./measures.vs.k.R ../output_all/6ligand 6 && ./cluster_metric_graphs.R ../output_all/6ligand
nice -10 ./measures.vs.k.R ../output_all/allLig 6 && ./cluster_metric_graphs.R ../output_all/allLig


